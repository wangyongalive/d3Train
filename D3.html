<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <meta name="content-class" content="maxiang"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2150"/>

<div><span lang="v2" style="color: #2c3f51; line-height: 1.6; background: none;"><del style="position:relative;display:block;z-index:10;"><a href="http://maxiang.io/#/?provider=evernote&amp;guid=2b39f530-0a20-4562-bb25-99fa19efa851&amp;notebook=%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%AC%94%E8%AE%B0%E6%9C%AC" style="position: absolute;color: #FFF;text-decoration: none;font-size: 12px;height: 25px;border-radius: 0;margin-top: -20px;right: 15px;background: rgba(0, 0, 0, 0);border-left: 10px solid #BB3A34;border-right: 10px solid #BB3A34;border-bottom: 5px solid rgba(0, 0, 0, 0);width: 0;text-indent:-100000px;">Edit</a></del><div style="color: #2c3f51; line-height: 1.6;">
                        
                    



<h3 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 21px; margin-bottom: 10.5px; font-size: 27.2px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">D3.js</h3>

<p style="margin: 0 0 1.1em; line-height: 1.6;"></p>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第一章 简介和安装</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">D3 是什么</code></p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">D3 的全称是（Data-Driven Documents），顾名思义可以知道是一个被数据驱动的文档。听名字有点抽象，说简单一点，其实就是一个 JavaScript 的函数库，使用它主要是用来做数据可视化的。如果你不知道什么是 JavaScript ，请先学习一点 JavaScript 的基础知识。</p>
</blockquote>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><a href="http://www.w3school.com.cn/js/" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">W3School 的 JavaScript 教程</a></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">为什么要数据可视化</code></p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">现在有一组数据， [4 ， 32 ， 15 ， 16 ， 42 ， 25 ] ，你能一眼看出它们的大小关系吗？当然这里的数据不算多，有那眼疾手快的家伙站出来说我能一眼看出来！但更直观的是用图形显示，如下图： <br/>
  <img src="D3_files/.1531382062354.png" type="image/png" data-filename="./1531382062354.png" alt="Alt text" longdesc="./1531382062354.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
  通过图形的显示，能很清楚地知道他们的大小关系。当然，D3 能力远不止如此，这只是一个很小的应用。把<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">枯燥乏味复杂</code>的数据，用<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">简单明了</code>的图形表示出来，这就是数据可视化。</p>
</blockquote>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">D3 有多受欢迎</code> <br/>
D3 是一个开源项目，作者是纽约时报的工程师。D3 项目的代码托管于 GitHub（一个开发管理平台，目前已经是全世界最流行的代码托管平台，云集了来自世界各地的优秀工程师）。 <br/>
<a href="https://github-ranking.anytao.net/repositories" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">https://github-ranking.anytao.net/repositories</a></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531382281741.png" type="image/png" data-filename="./1531382281741.png" alt="Alt text" longdesc="./1531382281741.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">如何学习和使用 D3</code> <br/>
以下是几个学习 D3 的站点：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">官方网站 <br/>
<a href="http://d3js.org/" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">http://d3js.org/</a> <br/>
包含有很多示例和 API，要想得心应手的使用 D3，熟悉 API 是避不开的。</li>
<li style="line-height: 1.6;">Mike Bostock 的博客和作品展示板 <br/>
<a href="http://bost.ocks.org/mike/" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">http://bost.ocks.org/mike/</a></li>
<li style="line-height: 1.6;">Web 数据可视化工具 <br/>
<a href="https://github.com/jobbole/awesome-javascript-cn#data-visualization" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">https://github.com/jobbole/awesome-javascript-cn#data-visualization</a></li>
<li style="line-height: 1.6;">可视化技术栈及学习计划 <br/>
<a href="https://segmentfault.com/a/1190000010175892" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">https://segmentfault.com/a/1190000010175892</a></li>
<li style="line-height: 1.6;">API <br/>
<a href="https://github.com/d3/d3/wiki/API--%E4%B8%AD%E6%96%87%E6%89%8B%E5%86%8C" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">https://github.com/d3/d3/wiki/API–%E4%B8%AD%E6%96%87%E6%89%8B%E5%86%8C</a></li>
</ul>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">安装D3</code> <br/>
D3 是一个 JavaScript 函数库，并不需要通常所说的<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">安装</code>。它只有一个文件，在 HTML 中引用即可。有两种方法： <br/>
（1）下载 D3.js 的文件</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">d3.zip</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">解压后，在 HTML 文件中包含相关的 js 文件即可。 <br/>
（2）直接包含网络的链接</p>

<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&lt;script src=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;http://d3js.org/d3.v3.min.js&quot;</span> charset=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;utf-8&quot;</span>&gt;<span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">script</span>&gt;</span></span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><a href="https://www.bootcdn.cn/" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">bootsdn</a> <br/>
这种方法比较简单，但要保持网络连接有效。</p>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">学习 D3 需要什么预备知识</code> <br/>
想要通过 D3 来开启数据可视化之旅的朋友，需要什么预备知识呢？</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">HTML：超文本标记语言，用于设定网页的内容</li>
<li style="line-height: 1.6;">CSS：层叠样式表，用于设定网页的样式</li>
<li style="line-height: 1.6;">JavaScript：一种直译式脚本语言，用于设定网页的行为</li>
<li style="line-height: 1.6;">DOM：文档对象模型，用于修改文档的内容和结构</li>
<li style="line-height: 1.6;">SVG：可缩放矢量图形，用于绘制可视化的图形</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><a href="http://www.runoob.com/" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">W3C菜鸟教程</a></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">需要什么工具</code></p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">制作网页常用的工具即可。 <br/>
  记事本软件：Notepad++、Editplus、Sublime Text、<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">webstrom</code> 等，选择自己喜欢的即可。 <br/>
  浏览器：IE9 以上、Firefox、Chrome 等，推荐用 <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">Chrome</code> <br/>
  服务器软件：Apache、Tomcat 等 <br/>
  其中，服务器软件可能不是必须的，不过 D3 中有些函数需要将 HTML 文件放置于服务器目录下，才能正常使用,比如d3.csv。</p>
</blockquote>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第二章 第一个程序</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;">选择元素和绑定数据是 D3 最基础的内容，本文将对其进行一个简单的介绍。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531383200008.png" type="image/png" data-filename="./1531383200008.png" alt="Alt text" longdesc="./1531383200008.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">如何选择元素</code> <br/>
在 D3 中，用于选择元素的函数有两个：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">d3.select()：是选择所有指定元素的<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">第一个</code></li>
<li style="line-height: 1.6;">d3.selectAll()：是选择指定元素的<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">全部</code></li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">这两个函数返回的结果称为选择集。 <br/>
例如，选择集的常见用法如下。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> body = d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择文档中的body元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> p1 = body.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>);      <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择body中的第一个p元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> p = body.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>);    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择body中的所有p元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> svg = body.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;svg&quot;</span>);   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择body中的svg元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> rects = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>);  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择svg中所有的react元素</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">如何绑定数据</code> <br/>
D3 有一个很独特的功能：能将<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">数据</code>绑定到<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">DOM</code>上，也就是绑定到文档上。这么说可能不好理解，例如网页中有段落元素 p 和一个整数 5，于是可以将整数 5 与 p 绑定到一起。绑定之后，当需要依靠这个数据才操作元素的时候，会很方便。 <br/>
D3 中是通过以下两个函数来绑定数据的：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">datum()：绑定<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">一个数据</code>到选择集上</li>
<li style="line-height: 1.6;">data()：绑定<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">一个数组</code>到选择集上，数组的各项值分别与选择集的各元素绑定</li>
</ul>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">p</span>&gt;</span>Apple<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">p</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">p</span>&gt;</span>Pear<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">p</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">p</span>&gt;</span>Banana<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">p</span>&gt;</span></span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">datum() <br/>
假设有一字符串 China，要将此字符串分别与三个段落元素绑定，代码如下:</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> str = <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;China&quot;</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>).selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>).datum(str).text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;第 &quot;</span> + i + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot; 个元素绑定的数据是 &quot;</span> + d;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        });
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">在上面用到了一个无名函数 function(d, i)。其包含两个参数，其中：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">d 代表数据，也就是与某元素绑定的数据。</li>
<li style="line-height: 1.6;">i 代表索引，代表数据的索引号，从 0 开始。</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">data() <br/>
有一个数组，接下来要分别将数组的各元素绑定到三个段落元素上。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = [<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;I like dog&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;I like cat&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;I like snake&quot;</span>];
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>).selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>).data(dataset)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            });
</div></code></pre>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第三章 选择、插入、删除元素</h4>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531396536606.png" type="image/png" data-filename="./1531396536606.png" alt="Alt text" longdesc="./1531396536606.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">选择特定的元素</code> <br/>
选择第一个p元素</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//  选择第一个p元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>).select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>).style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;color&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;red&quot;</span>)
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">选择三个 p 元素</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 选择三个 p 元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>).selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>).style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;color&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;red&quot;</span>);
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">选择第二个 p 元素</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 有不少方法，一种比较简单的是给第二个元素添加一个 id 号。</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 然后，使用 select 选择元素，注意参数中 id 名称前要加 # 号</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 选择第二个 p 元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>).select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;#myid&quot;</span>).style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;color&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;red&quot;</span>);
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">选择后两个 p 元素</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 给后两个元素添加 class 选择后两个 p 元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>).selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;.myclass&quot;</span>).style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;color&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;red&quot;</span>);
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">其他方法</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 运用 function(d, i),参数 i 是代表索引号的，于是便可以用条件判定语句来指定执行的元素。</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot; body&quot;</span>).selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>).style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;color&quot;</span>,<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d,i</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">if</span>(i==<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>){
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;red&quot;</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            }
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        })
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">插入元素</code> <br/>
插入元素涉及的函数有两个：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">append()：在选择集<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">末尾</code>插入元素</li>
<li style="line-height: 1.6;">insert()：在选择集<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">前面</code>插入元素</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">append</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// append()</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        body.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .text(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;append p element&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;color&quot;</span>,<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;green&quot;</span>)
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">insert</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// insert()</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 在 body 中 id 为 myid 的元素前添加一个段落元素。</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        body.insert(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;#myid&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .text(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;insert p element&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;color&quot;</span>,<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;blue&quot;</span>)
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">删除元素</code></p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">remove</li>
</ul>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> p = body.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;#myid&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">p.remove();
</div></code></pre>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第四章 绘制矩形</h4>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531639129775.png" type="image/png" data-filename="./1531639129775.png" alt="Alt text" longdesc="./1531639129775.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">画布</code> <br/>
前面的处理对象都是 HTML 的文字，没有涉及图形的制作。 <br/>
要绘图，首要需要的是一块绘图的<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">“画布”</code>。 <br/>
HTML 5 提供两种强有力的“画布”: SVG 和 Canvas。 <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">SVG 是什么</code> <br/>
SVG，指可缩放矢量图形（Scalable Vector Graphics），是用于描述二维矢量图形的一种图形格式，是由万维网联盟制定的开放标准。 SVG 使用 XML 格式来定义图形，除了 IE8 之前的版本外，绝大部分浏览器都支持 SVG，可将 SVG 文本直接嵌入 HTML 中显示。 <br/>
SVG 有如下特点：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">SVG 绘制的是矢量图，因此对图像进行放大<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">不会失真</code>。</li>
<li style="line-height: 1.6;">基于 XML，可以为每个元素添加 JavaScript <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">事件处理器</code>。</li>
<li style="line-height: 1.6;">每个图形均视为<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">对象</code>，更改对象的属性，图形也会改变。</li>
<li style="line-height: 1.6;">不适合游戏应用</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><a href="http://www.runoob.com/svg/svg-tutorial.html" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">SVG 教程</a></p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">矩形 </li>
<li style="line-height: 1.6;">圆形 </li>
<li style="line-height: 1.6;">椭圆 </li>
<li style="line-height: 1.6;">线 </li>
<li style="line-height: 1.6;">折线 </li>
<li style="line-height: 1.6;">多边形 </li>
<li style="line-height: 1.6;">路径</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">在 SVG 中，x 轴的正方向是水平向右，y 轴的正方向是垂直向下的。 <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">base</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">svg</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">xmlns</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;http://www.w3.org/2000/svg&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">width</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;600&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">height</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;600&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">version</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;1.1&quot;</span>&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 矩形 --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">rect</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">width</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;200&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">height</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;100&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">x</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;20&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">y</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;20&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">style</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill:red;stroke:blue;stroke-width:4&quot;</span>/&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- rx 和 ry 属性可使矩形产生圆角 --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">rect</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">width</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;200&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">height</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;100&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">x</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;250&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">y</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;20&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">rx</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;20&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">ry</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;10&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">style</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill:red;stroke:blue;stroke-width:4&quot;</span>/&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 圆 --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">circle</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">cx</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;100&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">cy</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;280&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">r</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;80&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">style</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill:yellow&quot;</span>/&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 椭圆 --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- RX属性定义的水平半径 --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- RY属性定义的垂直半径 --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">ellipse</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">cx</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;330&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">cy</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;280&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">rx</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;100&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">ry</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;80&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">style</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill:yellow&quot;</span>/&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 直线  --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">line</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">x1</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;0&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">x2</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;600&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">y1</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;0&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">y2</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;360&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">style</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;stroke:#000;stroke-width:4&quot;</span>/&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 多边形 --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- points 属性定义多边形每个角的 x 和 y 坐标 --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">polygon</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">points</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;100,20 20,90 20,200&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">style</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill:green;stroke:orange;stroke-width:4&quot;</span>/&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 曲线 --&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">polyline</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">points</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;100,20 20,90 20,200&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">style</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill:green;stroke:orange;stroke-width:4&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">transform</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(100,0)&quot;</span>/&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">svg</span>&gt;</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">path</code> <br/>
给出一个坐标点，在坐标点前面添加一个英文字母，表示如何运动到此坐标点。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">svg</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">xmlns</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;http://www.w3.org/2000/svg&quot;</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">version</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;1.1&quot;</span>&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">path</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">d</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;M150 0 L75 200 L225 200 Z&quot;</span> /&gt;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">svg</span>&gt;</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">添加画布</code> <br/>
使用 D3 在 body 元素中添加 svg 的代码如下。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> width = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">300</span>;  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//画布的宽度</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> height = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">300</span>;   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//画布的高度</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> svg = d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>)     <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择文档中的body元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;svg&quot;</span>)          <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加一个svg元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;width&quot;</span>, width)       <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//设定宽度</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;height&quot;</span>, height);    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//设定高度</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">绘制矩形</code></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;">在 SVG 中，矩形的元素标签是 rect</p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">x：矩形左上角的 x 坐标 <br/>
  y：矩形左上角的 y 坐标 <br/>
  width：矩形的宽度 <br/>
  height：矩形的高度</p>
</blockquote>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = [<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">250</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">210</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">170</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">130</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">90</span>];  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//数据（表示矩形的宽度）</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> rectHeight = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">25</span>;   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//每个矩形所占的像素高度(包括空白)</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 选择svg内所有的矩形</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .data(dataset) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 绑定数组</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .enter()  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 指定选择集的enter部分</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 添加足够数量的矩形元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;x&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">20</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 分别给各元素的属性赋值</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> i * rectHeight;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;width&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;height&quot;</span>, rectHeight - <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;steelblue&quot;</span>);
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">下面这段代码以后会常常出现在 D3 的代码中，请务必牢记。 <br/>
当有数据，而没有足够图形元素的时候，使用此方法可以添加足够的元素。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>)   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择svg内所有的矩形</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .data(dataset)  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//绑定数组</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .enter()        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//指定选择集的enter部分</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加足够数量的矩形元素</span>
</div></code></pre>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第五章 比例尺的使用</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;">上一章里曾经提到过直接用数值的大小来代表像素不是一种好方法，本章正是要解决此问题。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531400578145.png" type="image/png" data-filename="./1531400578145.png" alt="Alt text" longdesc="./1531400578145.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">为什么需要比例尺</code></p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">前面制作了一个柱形图，当时有一个数组： <br/>
  var dataset = [ 250 , 210 , 170 , 130 , 90 ]; <br/>
  绘图时，直接使用 250 给矩形的宽度赋值，即矩形的宽度就是 250 个像素。 <br/>
  此方式非常具有局限性，如果数值<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">过大</code>或<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">过小</code>，例如： <br/>
  var dataset_1 = [ 2.5 , 2.1 , 1.7 , 1.3 , 0.9 ]; <br/>
  var dataset_2 = [ 2500, 2100, 1700, 1300, 900 ]; <br/>
  对以上两个数组，绝不可能用 2.5 个像素来代表矩形的宽度，那样根本看不见；也不可能用 2500 个像素来代表矩形的宽度，因为画布没有那么长。 <br/>
  <strong style="font-weight: bold; line-height: 1.6;">将某一区域的值映射到另一区域，其大小关系不变</strong></p>
</blockquote>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">有哪些比例尺</code> <br/>
比例尺，很像数学中的函数。对于y=f(x)，当 x 的值确定时，y 的值也就确定了。 <br/>
在数学中，x 的范围被称为定义域，y 的范围被称为值域。 <br/>
D3 的比例尺中分别被称为 domain 和 range，只需要指定 domain 和 range 的范围，就可以定义一个比例尺了。 <br/>
D3 提供了多种比例尺，下面介绍最常用的两种。</p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">线性比例尺</code> <br/>
线性比例尺，能将一个连续的区间，映射到另一区间。 <br/>
y= kx + b <br/>
<strong style="font-weight: bold; line-height: 1.6;">将 dataset 中最小的值，映射成 0；将最大的值，映射成 300。</strong></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = [<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1.2</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2.3</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0.9</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1.5</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">3.3</span>];
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> min = d3.min(dataset); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 求数组的最小值</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> max = d3.max(dataset); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 求数组的最大值</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> linear = d3.scale.linear() <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 返回一个线性比例尺</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .domain([min, max]) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 定义域</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .range([<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">300</span>]); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 值域</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        linear(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0.9</span>);    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//返回 0</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        linear(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2.3</span>);    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//返回 175</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        linear(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">3.3</span>);    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//返回 300</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">序数比例尺</code> <br/>
有时候，定义域和值域不一定是连续的。例如，有两个数组：</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> index = [<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">3</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">4</span>];
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> color = [<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;red&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;blue&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;green&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;yellow&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;black&quot;</span>];
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">规定0 对应颜色 red，1 对应 blue，依次类推。这时候就可以用序列比例尺。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> ordinal = d3.scale.ordinal()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        .domain(index)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        .range(color);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">ordinal(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//返回 red</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">ordinal(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//返回 green</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">ordinal(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">4</span>); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//返回 black</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">颜色比例尺</code> <br/>
要给图表设定颜色，每次手动设置非常麻烦，这时候可以使用颜色比例尺。它们的颜色都结果精心的色彩搭配，相当美观。</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">category10  10种颜色</li>
<li style="line-height: 1.6;">category20()   20种颜色</li>
<li style="line-height: 1.6;">category20b()  20种颜色</li>
<li style="line-height: 1.6;">category20c()  20种颜色</li>
</ul>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&lt;html&gt;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">head</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">meta</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">charset</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;utf-8&quot;</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">title</span>&gt;</span>颜色比例尺<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">title</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">head</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">body</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">script</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">src</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;https://cdn.bootcss.com/d3/3.5.15/d3.js&quot;</span>&gt;</span><span style="display: inline; line-height: 1.6; background-color: transparent;"></span><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">script</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">script</span>&gt;</span><span style="display: inline; line-height: 1.6; background-color: transparent;"></span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> width = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1000</span>;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> height = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">600</span>;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = d3.range(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">15</span>); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 返回[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> color = d3.scale.category10();</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> svg = d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>).append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;svg&quot;</span>)</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;width&quot;</span>, width)</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;height&quot;</span>, height);</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> circle = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;circle&quot;</span>)</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .data(dataset)</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .enter()</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;circle&quot;</span>)</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">(d, i)</span> </span>{</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">20</span> + i * <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">60</span>;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            })</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cy&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">100</span>)</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;r&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">15</span>)</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">(d, i)</span> </span>{</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> color(i);</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            });</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">script</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">body</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">html</span>&gt;</span></span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">给柱形图添加比例尺</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&lt;html&gt;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">head</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">meta</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">charset</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;utf-8&quot;</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">title</span>&gt;</span>添加坐标轴<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">title</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">head</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">body</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">script</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">src</span>=<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;https://cdn.bootcss.com/d3/3.5.15/d3.js&quot;</span>&gt;</span><span style="display: inline; line-height: 1.6; background-color: transparent;"></span><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">script</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">script</span>&gt;</span><span style="display: inline; line-height: 1.6; background-color: transparent;"></span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> width = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">300</span>;    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//画布的宽度</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> height = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">300</span>;   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//画布的高度</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> svg = d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>)             <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择文档中的body元素</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;svg&quot;</span>)              <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加一个svg元素</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;width&quot;</span>, width)       <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//设定宽度</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;height&quot;</span>, height);    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//设定高度</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = [<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">250</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">210</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">170</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">130</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">90</span>];  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//数据（表示矩形的宽度）</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> linear = d3.scale.linear()</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        .domain([<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>, d3.max(dataset)])</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        .range([<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">100</span>]);</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> rectHeight = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">25</span>;   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//每个矩形所占的像素高度(包括空白)</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">        svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 选择svg内所有的矩形</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .data(dataset) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 绑定数组</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .enter()  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 指定选择集的enter部分</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 添加足够数量的矩形元素</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;x&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">20</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 添加了元素之后，就需要分别给各元素的属性赋值</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">(d, i)</span> </span>{</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> i * rectHeight;</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            })</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;width&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">(d)</span> </span>{</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> linear(d); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// //在这里用比例尺</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            })</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;height&quot;</span>, rectHeight - <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>)</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;steelblue&quot;</span>);</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">script</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">body</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">html</span>&gt;</span></span>
</div></code></pre>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第六章 坐标轴</h4>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531401743135.png" type="image/png" data-filename="./1531401743135.png" alt="Alt text" longdesc="./1531401743135.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;">坐标轴，是可视化图表中经常出现的一种图形，由一些<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">列线段</code>和<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">刻度</code>组成。坐标轴在 SVG 中是没有现成的图形元素的，需要用其他的元素<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">组合</code>构成。 <br/>
在 SVG 画布的预定义元素里，有六种基本图形：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">矩形</li>
<li style="line-height: 1.6;">圆形</li>
<li style="line-height: 1.6;">椭圆</li>
<li style="line-height: 1.6;">线段</li>
<li style="line-height: 1.6;">折线</li>
<li style="line-height: 1.6;">多边形</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">另外，还有一种比较特殊，也是功能最强的元素：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">路径</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">画布中的所有图形，都是由以上七种元素组成。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">g</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 第一个刻度 --&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">g</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">line</span>&gt;</span><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">line</span>&gt;</span>   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 第一个刻度的直线 --&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">text</span>&gt;</span><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">text</span>&gt;</span>   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 第一个刻度的文字 --&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">g</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 第二个刻度 --&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">g</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">line</span>&gt;</span><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">line</span>&gt;</span>   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 第二个刻度的直线 --&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">text</span>&gt;</span><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">text</span>&gt;</span>   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 第二个刻度的文字 --&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">g</span>&gt;</span> </span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;">...</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">&lt;!-- 坐标轴的轴线 --&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">path</span>&gt;</span><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">path</span>&gt;</span></span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">g</span>&gt;</span></span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">分组元素 ，是 SVG 画布中的元素，意思是 group。此元素是将其他元素进行组合的容器，在这里是用于将坐标轴的其他元素分组存放。</p>

<p style="margin: 0 0 1.1em; line-height: 1.6;">如果需要手动添加这些元素就太麻烦了，为此，D3 提供了一个组件：<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">d3.svg.axis()</code>。 <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">定义坐标轴</code> <br/>
要生成<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">坐标轴</code>，需要用到<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">比例尺</code>，它们二者经常是一起使用的。在上一章的数据和比例尺的基础上，添加一个坐标轴的组件。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//数据</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = [ <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2.5</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2.1</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1.7</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1.3</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0.9</span> ];
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//定义比例尺</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> linear = d3.scale.linear()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .domain([<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>, d3.max(dataset)])
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .range([<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">250</span>]);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> axis = d3.svg.axis()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .scale(linear)      <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 指定比例尺</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .orient(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;bottom&quot;</span>)   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 指定刻度的方向</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .ticks(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">7</span>);          <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 指定刻度的数量</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">在 SVG 中添加坐标轴</code> <br/>
定义了坐标轴之后，只需要在 SVG 中添加一个分组元素 ，再将坐标轴的其他元素添加到这个 里即可。代码如下：</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">svg.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;g&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   .call(axis);
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">上面有一个 call() 函数，其参数是前面定义的坐标轴 axis。</p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">设定坐标轴的样式和位置</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531643246414.png" type="image/png" data-filename="./1531643246414.png" alt="Alt text" longdesc="./1531643246414.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
默认的坐标轴样式不太美观,需要分别定义了类 axis 下的 path、line、text 元素的样式</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&lt;<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">style</span>&gt;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #a6e22e; background-color: transparent;">.axis</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">path</span>,
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #a6e22e; background-color: transparent;">.axis</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">line</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">fill</span>: none;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">stroke</span>: black;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">shape-rendering</span>: crispEdges;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">}
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #a6e22e; background-color: transparent;">.axis</span> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">text</span> {
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">font-family</span>: sans-serif;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">font-size</span>: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">11px</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">}
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">&lt;/<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">style</span>&gt;
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">接下来，只需要将坐标轴的类设定为 axis 即可。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">svg.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;g&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;class&quot;</span>,<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;axis&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;transform&quot;</span>,<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(20,130)&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  .call(axis);
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">坐标轴的位置，可以通过 transform 属性来设定。</p>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第七章 完整的柱形图</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;">一个完整的柱形图包含三部分：<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">矩形</code>、<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">文字</code>、<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">坐标轴</code>。本章将对前几章的内容进行综合的运用,对内容进行综合的运用，制作一个实用的柱形图，内容包括：选择集、数据绑定、比例尺、坐标轴等内容。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531405124395.png" type="image/png" data-filename="./1531405124395.png" alt="Alt text" longdesc="./1531405124395.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">添加 SVG 画布</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//画布大小</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> width = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">400</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> height = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">400</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//在 body 里添加一个 SVG 画布   </span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> svg = d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;svg&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;width&quot;</span>, width)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;height&quot;</span>, height);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//画布周边的空白</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 定义了一个 padding，是为了给 SVG 的周边留一个空白，最好不要将图形绘制到边界上</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> padding = {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">left</span>:<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">30</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">right</span>:<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">30</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">top</span>:<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">20</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">bottom</span>:<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">20</span>};
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">定义数据和比例尺</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//定义一个数组</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = [<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">10</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">20</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">30</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">40</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">33</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">24</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">12</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">5</span>];
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// x轴的比例尺</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// x轴使用序数比例尺</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> xScale = d3.scale.ordinal()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .domain(d3.range(dataset.length))
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .rangeRoundBands([<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>, width - padding.left - padding.right]); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//  指定输出范围为连续区间，区间段的起点均为整数</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// y轴的比例尺</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// y轴使用线性比例尺</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> yScale = d3.scale.linear()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .domain([<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>,d3.max(dataset)])
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .range([height - padding.top - padding.bottom, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>]); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 反过来</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">定义坐标轴</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//定义x轴</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> xAxis = d3.svg.axis()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .scale(xScale)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .orient(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;bottom&quot;</span>); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// x 轴刻度的方向向下 </span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//定义y轴</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> yAxis = d3.svg.axis()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .scale(yScale)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .orient(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;left&quot;</span>); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// y 轴的向左</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">添加矩形和文字元素</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//矩形之间的空白</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> rectPadding = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">4</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加矩形元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> rects = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;.MyRect&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .data(dataset)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;class&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;MyRect&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;transform&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(&quot;</span> + padding.left + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;,&quot;</span> + padding.top + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;)&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;x&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> xScale(i) + rectPadding / <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> yScale(d);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;width&quot;</span>, xScale.rangeBand() - rectPadding)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;height&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> height - padding.top - padding.bottom - yScale(d);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            });
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加文字元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> texts = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;.MyText&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .data(dataset)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;text&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;class&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;MyText&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;transform&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(&quot;</span> + padding.left + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;,&quot;</span> + padding.top + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;)&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;x&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> xScale(i) + rectPadding / <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> yScale(d);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;dx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;"></span>) </span>{ <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 是文本相对基点x方向右偏移的距离</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> (xScale.rangeBand() - rectPadding) / <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;dy&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 是文本相对基点y方向下偏移的距离</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">20</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            });
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">添加坐标轴的元素</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加x轴</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        svg.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;g&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;class&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;axis&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;transform&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(&quot;</span> + padding.left + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;,&quot;</span> + (height - padding.bottom) + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;)&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .call(xAxis);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加y轴</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        svg.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;g&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;class&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;axis&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;transform&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(&quot;</span> + padding.left + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;,&quot;</span> + padding.top + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;)&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .call(yAxis);
</div></code></pre>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第八章 动画效果</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">什么是动态效果</code></p>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 0; line-height: 1.6;">前面制作的图表是一蹴而就地出现，然后绘制完成后不再发生变化的，这是<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">静态</code>的图表。 <br/>
  <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">动态</code>的图表，是指图表在某一时间段会发生某种变化，可能是<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">形状</code>、<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">颜色</code>、<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">位置</code>等。 <br/>
  例如，有一个圆，圆心为 (100, 100)。现在我们希望圆的 x 坐标从 100 移到 300，并且移动过程在 2 秒的时间内发生。 <br/>
  这种时候就需要用到动态效果，在 D3 里我们称之为<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">过渡（transition）</code>。</p>
</blockquote>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">实现动态的方法</code> <br/>
D3 提供了 4 个方法用于实现图形的过渡：从<strong style="font-weight: bold; line-height: 1.6;">状态 A</strong> 变为<strong style="font-weight: bold; line-height: 1.6;">状态 B</strong>。</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;"><p style="margin: 0 0 1.1em; line-height: 1.6;">transition() <br/>
启动过渡效果。 <br/>
其前后是图形变化前后的状态（形状、位置、颜色等等），例如：</p>

<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>,<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;red&quot;</span>)         <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//初始颜色为红色</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.transition()               <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//启动过渡</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>,<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;steelblue&quot;</span>)   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//终止颜色为铁蓝色</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; margin-bottom: 0; line-height: 1.6;">D3 会自动对两种颜色（红色和铁蓝色）之间的颜色值（RGB值）进行插值计算，得到过渡用的颜色值。</p></li>
<li style="line-height: 1.6;"><p style="margin: 0 0 1.1em; margin-bottom: 0; line-height: 1.6;">duration() <br/>
指定过渡的持续时间，单位为毫秒。 <br/>
如 duration(2000) ，指持续 2000 毫秒，即 2 秒。</p></li>
<li style="line-height: 1.6;"><p style="margin: 0 0 1.1em; line-height: 1.6;">ease() <br/>
指定过渡的方式，常用的有</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;">
<li style="line-height: 1.6;">linear：普通的线性变化</li>
<li style="line-height: 1.6;">circle：慢慢地到达变换的最终状态</li>
<li style="line-height: 1.6;">elastic：带有弹跳的到达最终状态</li>
<li style="line-height: 1.6;">bounce：在最终状态处弹跳几次</li></ul>

<p style="margin: 0 0 1.1em; margin-bottom: 0; line-height: 1.6;">调用时，格式形如： ease(“bounce”)</p></li>
<li style="line-height: 1.6;"><p style="margin: 0 0 1.1em; margin-bottom: 0; line-height: 1.6;">delay() <br/>
指定延迟的时间，表示一定时间后才开始转变，单位同样为毫秒。此函数可以对<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">整体</code>指定延迟，也可以对<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">个别</code>指定延迟。</p></li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">对整体指定时</strong></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.transition()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.duration(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1000</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.delay(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">500</span>)
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">如此，图形整体在<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">延迟</code> 500 毫秒后发生变化，<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">变化</code>的时长为 1000 毫秒。因此，过渡的<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">总时长</code>为1500毫秒。</p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><strong style="font-weight: bold; line-height: 1.6;">对个别图形进行指定时</strong></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.transition()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.duration(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1000</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.delay(funtion(d,i){
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">200</span>*i;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">})
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">如此，假设有 10 个元素，那么第 1 个元素延迟 0 毫秒（因为 i = 0），第 2 个元素延迟 200 毫秒，第 3 个延迟 400 毫秒，依次类推….整个过渡的长度为 200 * 9 + 1000 = 2800 毫秒。</p>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">实现简单的动态效果</code> <br/>
在 SVG 画布里添加三个圆，圆出现之后，立即启动过渡效果。 <br/>
第一个圆，要求移动 x 坐标。 <br/>
第二个圆，要求既移动 x 坐标，又改变颜色。 <br/>
第三个圆，要求既移动 x 坐标，又改变颜色，还改变半径</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> circle1 = svg.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;circle&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">100</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cy&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">100</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;r&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">45</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;green&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//在1秒（1000毫秒）内将圆心坐标由100变为300</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        circle1.transition()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .duration(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1000</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">300</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> circle2 = svg.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;circle&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">100</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cy&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">200</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;r&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">45</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;green&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//在1.5秒（1500毫秒）内将圆心坐标由100变为300，</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//将颜色从绿色变为红色</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        circle2.transition()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .duration(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1500</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">300</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;red&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> circle3 = svg.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;circle&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">100</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cy&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">300</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;r&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">45</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;green&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//在2秒（2000毫秒）内将圆心坐标由100变为300</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//将颜色从绿色变为红色</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//将半径从45变成25</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//过渡方式采用bounce（在终点处弹跳几次）</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        circle3.transition()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .duration(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2000</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .ease(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;bounce&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">300</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;red&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;r&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">25</span>);
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">给柱形图加上动态效果</code> <br/>
在添加<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">文字元素</code>和<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">矩形元素</code>的时候，<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">启动过渡效果</code>，让各柱形和文字缓慢升至目标高度，并且在目标处跳动几次。两者发生变化的都是 y 坐标。写清楚<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">起始状态</code>和<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">终止状态</code>。 <br/>
以下是为文字添加过渡效果的代码：</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y&quot;</span>,<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> min = yScale.domain()[<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>];
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> yScale(min);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">})
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.transition()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.delay(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d,i</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> i * <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">200</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">})
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.duration(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2000</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.ease(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;bounce&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">.attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y&quot;</span>,<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> yScale(d);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">});
</div></code></pre>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第九章 理解 Update、Enter、Exit</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;">前几章里，反复出现了形如以下的代码。当时并没有深究这段代码是什么意思，本章将对此进行讲解。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>)   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择svg内所有的矩形</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .data(dataset)      <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//绑定数组</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .enter()            <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//指定选择集的enter部分</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>)     <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加足够数量的矩形元素</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">什么是 Update、Enter、Exit</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531411630906.png" type="image/png" data-filename="./1531411630906.png" alt="Alt text" longdesc="./1531411630906.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;">以下面这个例子为例，如果数组为 [3, 6, 9, 12, 15]，将此数组绑定到三个 p 元素的选择集上。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531412615083.png" type="image/png" data-filename="./1531412615083.png" alt="Alt text" longdesc="./1531412615083.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">update 部分的处理办法一般是：更新属性值。</li>
<li style="line-height: 1.6;">enter 部分的处理办法一般是：添加元素后，赋予属性值。</li>
<li style="line-height: 1.6;">exit 部分的处理办法一般是：删除元素（remove）。</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">Update 和 Enter 的使用</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = [ <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">3</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">6</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">9</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">12</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">15</span> ];
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择body中的p元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> p = d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>).selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//获取update部分</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> update = p.data(dataset);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//获取enter部分</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> enter = update.enter();
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//update部分的处理：更新属性值</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">update.text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;update &quot;</span> + d;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">});
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//enter部分的处理：添加元素后赋予属性值</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">enter.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;enter &quot;</span> + d;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    });
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">结果如下图，update 部分和 enter 部分被绑定的数据很清晰地表示了出来。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531650001513.png" type="image/png" data-filename="./1531650001513.png" alt="Alt text" longdesc="./1531650001513.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">Update 和 Exit 的使用</code> <br/>
当对应的元素过多时 （ 绑定数据数量 &lt; 对应元素 ），需要删掉多余的元素。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = [ <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">3</span> ];
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//选择body中的p元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> p = d3.select(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;body&quot;</span>).selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;p&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//获取update部分</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> update = p.data(dataset);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//获取exit部分</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> exit = update.exit();
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//update部分的处理：更新属性值</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">update.text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;update &quot;</span> + d;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">});
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//exit部分的处理：修改p元素的属性</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">exit.text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;exit&quot;</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    });
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//exit部分的处理通常是删除元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// exit.remove();</span>
</div></code></pre>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531650184080.png" type="image/png" data-filename="./1531650184080.png" alt="Alt text" longdesc="./1531650184080.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第十章 交互操作</h4>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531448236642.png" type="image/png" data-filename="./1531448236642.png" alt="Alt text" longdesc="./1531448236642.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
对可视化图表来说，交互能使图表更加生动，能表现更多内容。例如，<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">拖动</code>图表中某些图形、鼠标滑到图形上出现<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">提示框</code>、用触屏<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">放大</code>或<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">缩小</code>图形等等。 <br/>
用户用于交互的工具一般有三种：<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">鼠标</code>、<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">键盘</code>、<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">触屏</code>。 <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">如何添加交互</code> <br/>
对某一元素添加交互操作十分简单，代码如下：</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> circle = svg.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;circle&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">circle.on(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;click&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;"></span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//在这里添加交互内容</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">});
</div></code></pre>

<blockquote style="padding: 15px 20px; margin: 0 0 1.1em; border-left: 5px solid rgba(102,128,153,0.075); border-left-width: 10px; background-color: rgba(102,128,153,0.05); border-top-right-radius: 5px; border-bottom-right-radius: 5px;">
  <p style="margin: 0 0 1.1em; font-size: 1em; font-weight: 300; margin-bottom: 1.1em; line-height: 1.6;">on() 的第一个参数是<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">监听的事件</code>，第二个参数是监听到事件后<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">响应</code>的内容，第二个参数是一个函数。 <br/>
  鼠标常用的事件有:</p>
  
  <ul style="margin-top: 0; margin-bottom: 0; line-height: 1.6;"><li style="line-height: 1.6;">click：鼠标单击某元素时，相当于 mousedown 和 mouseup 组合在一起。</li>
  <li style="line-height: 1.6;">mouseover：光标放在某元素上。</li>
  <li style="line-height: 1.6;">mouseout：光标从某元素上移出来时。</li>
  <li style="line-height: 1.6;">mousemove：鼠标被移动的时候。</li>
  <li style="line-height: 1.6;">mousedown：鼠标按钮被按下。</li>
  <li style="line-height: 1.6;">mouseup：鼠标按钮被松开。</li>
  <li style="line-height: 1.6;">dblclick：鼠标双击。</li>
  </ul>
</blockquote>

<p style="margin: 0 0 1.1em; line-height: 1.6;">键盘常用的事件有三个：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">keydown：当用户按下任意键时触发，按住不放会重复触发此事件。该事件不会区分字母的大小写，例如“A”和“a”被视为一致。</li>
<li style="line-height: 1.6;">keypress：当用户按下字符键（大小写字母、数字、加号、等号、回车等）时触发，按住不放会重复触发此事件。该事件区分字母的大小写。</li>
<li style="line-height: 1.6;"><p style="margin: 0 0 1.1em; line-height: 1.6;">keyup：当用户释放键时触发，不区分字母的大小写。</p>

<p style="margin: 0 0 1.1em; margin-bottom: 0; line-height: 1.6;">触屏常用的事件有三个：</p></li>
<li style="line-height: 1.6;">touchstart：当触摸点被放在触摸屏上时。</li>
<li style="line-height: 1.6;">touchmove：当触摸点在触摸屏上移动时。</li>
<li style="line-height: 1.6;">touchend：当触摸点从触摸屏上拿开时。 </li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">带有交互的柱形图</code> <br/>
将柱形图的部分代码修改成如下代码： <br/>
填充颜色不要写在CSS里,因为CSS属性的级别比attr()的要高。 <br/>
当某个事件被监听到时，D3 会把当前的事件存到 d3.event 对象，里面保存了当前事件的各种参数。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加矩形元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> rects = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;.MyRect&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .data(dataset)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;rect&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// .attr(&quot;class&quot;, &quot;MyRect&quot;) // </span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;transform&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(&quot;</span> + padding.left + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;,&quot;</span> + padding.top + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;)&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;x&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> xScale(i) + rectPadding / <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> yScale(d);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;width&quot;</span>, xScale.rangeBand() - rectPadding)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;height&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> height - padding.top - padding.bottom - yScale(d);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;steelblue&quot;</span>)      <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 填充颜色不要写在CSS里</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .on(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;mouseover&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                d3.select(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// d3.select(this)，表示选择当前的元素</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;yellow&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// console.log(d3.event.screenX);</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            .on(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;mouseout&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                d3.select(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    .transition()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    .duration(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">500</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;steelblue&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            });
</div></code></pre>

<hr style="-moz-box-sizing: content-box; box-sizing: content-box; height: 0; margin-top: 21px; margin-bottom: 21px; border: 0; border-top: 1px solid rgba(102,128,153,0.1); margin: 2em 0; line-height: 1.6;"/>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第十一章 布局</h4>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531450018437.png" type="image/png" data-filename="./1531450018437.png" alt="Alt text" longdesc="./1531450018437.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">布局是什么</code> <br/>
布局，英文是 Layout。布局是 D3 中一个十分重要的概念。D3 与其它很多可视化工具不同，相对来说较底层，对初学者来说不太方便，但是一旦掌握了，就比其他工具更加得心应手。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531450222651.png" type="image/png" data-filename="./1531450222651.png" alt="Alt text" longdesc="./1531450222651.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">D3绘图</code>： <br/>
将数据变为图表，分为两步：计算和绘制。 <br/>
计算是指算出节点的位置、线段的端点、弧线的角度等。绘制是将计算所得的节点、线段等元素绘制在网页上。 <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">大部分绘图工具</code>: <br/>
将计算和绘制整合到一起。</p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">D3的优势</code> <br/>
极大提高了设计的自由度</p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">如何理解布局</code> <br/>
布局可以理解为<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">数据转换</code> <br/>
比如，有数据[10,20,30,40],要将其画成饼状图，需要将数据转换成扇形的起始角度和终止角度。</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">10 -&gt; 起始角度0，终止角度36</li>
<li style="line-height: 1.6;">20 -&gt; 起始角度36 ,终止角度108</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">布局有哪些</code> <br/>
D3 总共提供了 12 个布局：饼状图（Pie）、力导向图（Force）、弦图（Chord）、树状图（Tree）、集群图（Cluster）、捆图（Bundle）、打包图（Pack）、直方图（Histogram）、分区图（Partition）、堆栈图（Stack）、矩阵树图（Treemap）、层级图（Hierarchy）。 <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">饼状图（Pie）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531457914291.png" type="image/png" data-filename="./1531457914291.png" alt="Alt text" longdesc="./1531457914291.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">力导向图（Force）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531457929809.png" type="image/png" data-filename="./1531457929809.png" alt="Alt text" longdesc="./1531457929809.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">弦图（Chord）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531457937589.png" type="image/png" data-filename="./1531457937589.png" alt="Alt text" longdesc="./1531457937589.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">树状图（Tree）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531457948664.png" type="image/png" data-filename="./1531457948664.png" alt="Alt text" longdesc="./1531457948664.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">集群图（Cluster）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531457959655.png" type="image/png" data-filename="./1531457959655.png" alt="Alt text" longdesc="./1531457959655.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">捆图（Bundle）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531457966003.png" type="image/png" data-filename="./1531457966003.png" alt="Alt text" longdesc="./1531457966003.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">打包图（Pack）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531457972735.png" type="image/png" data-filename="./1531457972735.png" alt="Alt text" longdesc="./1531457972735.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">直方图（Histogram）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531458021184.png" type="image/png" data-filename="./1531458021184.png" alt="Alt text" longdesc="./1531458021184.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">分区图（Partition）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531458036521.png" type="image/png" data-filename="./1531458036521.png" alt="Alt text" longdesc="./1531458036521.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">堆栈图（Stack）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531458041862.png" type="image/png" data-filename="./1531458041862.png" alt="Alt text" longdesc="./1531458041862.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">矩阵树图（Treemap）</code></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531458047207.png" type="image/png" data-filename="./1531458047207.png" alt="Alt text" longdesc="./1531458047207.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第十二章 饼状图的制作</h4>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531458492502.png" type="image/png" data-filename="./1531458492502.png" alt="Alt text" longdesc="./1531458492502.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<strong style="font-weight: bold; line-height: 1.6;">展示离散数据点百分占比或者大小比较</strong> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">数据</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> dataset = [ <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">30</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">10</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">43</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">55</span> , <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">13</span> ];
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">布局(数据转换)</code></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> pie = d3.layout.pie();
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> piedata = pie(dataset);
</div></code></pre>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531459281643.png" type="image/png" data-filename="./1531459281643.png" alt="Alt text" longdesc="./1531459281643.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
千万记住：布局不是直接绘图，而是为了得到绘图所需的<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">数据</code>。</p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">绘制图形</code> <br/>
SVG 有一个元素，叫做<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">路径 path</code>，是 SVG 中功能最强的元素，它可以表示其它<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">任意的图形</code>。绘制饼状图需要使用<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">弧生成器</code>。它可以生成<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">弧的路径</code>。 <br/>
弧生成器返回的结果赋值给 arc。此时，arc 可以当做一个函数使用，把 piedata 作为参数传入，即可得到路径值。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> outerRadius = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">150</span>; <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 外半径</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> innerRadius = <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span>; <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 内半径，为0则中间没有空白</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> arc = d3.svg.arc()  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 弧生成器</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .innerRadius(innerRadius)   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//设置内半径</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .outerRadius(outerRadius);  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//设置外半径</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">在 svg 里添加足够数量的分组元素（g），每一个分组用于存放一段弧的相关元素。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> arcs = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;g&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .data(piedata)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;g&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;transform&quot;</span>,<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(&quot;</span>+ (width/<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>) +<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;,&quot;</span>+ (width/<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>) +<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;)&quot;</span>);
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">接下来对每个 g 元素，添加 path 。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">arcs.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;path&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>,<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d,i</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> color(i); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 颜色比例尺</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// .attr(&quot;d&quot;, function (d) {</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//     return arc(d); // 使用弧生成器获取路径</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// });</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;d&quot;</span>, arc); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//s arc本身就是一个函数,可以简写为arc</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">然后在每一个弧线中心添加文本。 <br/>
arc.centroid(d) 能算出弧线的中心坐标，返回一个[x,y]数组。 <br/>
text-anchor文本相对基点（x，y）的位置 </p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">start 文字在基点的右上方</li>
<li style="line-height: 1.6;">middle 文字在基点的正上方</li>
<li style="line-height: 1.6;">end 文字在基点的左上方</li>
</ul>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">arcs.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;text&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;transform&quot;</span>,<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(&quot;</span> + arc.centroid(d) + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;)&quot;</span>; <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 算出弧线的中心 </span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;text-anchor&quot;</span>,<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;middle&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.data; <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//  d.data，而不是d，因为被绑定的数据是对象</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    });
</div></code></pre>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第十三章 力导向图</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;">力导向图（Force-Directed Graph），是绘图的一种算法。在二维或三维空间里配置<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">节点</code>，节点之间用线连接，称为<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">连线</code>。各连线的长度几乎相等，且尽可能不相交。节点和连线都被施加了力的作用，力是根据节点和连线的相对位置计算的。根据力的作用，来计算节点和连线的运动轨迹，并不断降低它们的能量，最终达到一种能量很低的安定状态。 <br/>
<strong style="font-weight: bold; line-height: 1.6;">适合网络型、社交型图数据的可视化展示。</strong></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531461998072.png" type="image/png" data-filename="./1531461998072.png" alt="Alt text" longdesc="./1531461998072.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">数据</code> <br/>
节点（nodes）和连线（edges）的数组</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> nodes = [ { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">name</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;桂林&quot;</span> }, { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">name</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;广州&quot;</span> },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">              { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">name</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;厦门&quot;</span> }, { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">name</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;杭州&quot;</span> },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">              { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">name</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;上海&quot;</span> }, { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">name</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;青岛&quot;</span> },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">              { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">name</span>: <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;天津&quot;</span> } ];
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> edges = [ { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">source</span> : <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span> , <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">target</span>: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span> } , { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">source</span> : <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span> , <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">target</span>: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span> } ,
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">               { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">source</span> : <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">0</span> , <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">target</span>: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">3</span> } , { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">source</span> : <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span> , <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">target</span>: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">4</span> } ,
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">               { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">source</span> : <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span> , <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">target</span>: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">5</span> } , { <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">source</span> : <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span> , <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">target</span>: <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">6</span> } ];
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">布局(数据转换)</code> <br/>
定义一个力导向图的布局</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> force = d3.layout.force()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .nodes(nodes) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//指定节点数组</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .links(edges) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//指定连线数组</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .size([width,height]) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//指定作用域范围</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .linkDistance(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">150</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//指定连线长度</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      .charge([<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">-400</span>]); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//相互之间的作用力</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">使力学作用生效：</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">force.start();  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 开始计算布局</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">数据变换前后 <br/>
节点</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531462348121.png" type="image/png" data-filename="./1531462348121.png" alt="Alt text" longdesc="./1531462348121.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
转换后，节点对象里多了一些变量。其意义如下：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">index：节点的索引号</li>
<li style="line-height: 1.6;">px, py：节点上一个时刻的坐标</li>
<li style="line-height: 1.6;">x, y：节点的当前坐标</li>
<li style="line-height: 1.6;">weight：节点的权重</li>
</ul>

<p style="margin: 0 0 1.1em; line-height: 1.6;">连线的变化</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531462399893.png" type="image/png" data-filename="./1531462399893.png" alt="Alt text" longdesc="./1531462399893.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
可以看到，连线的两个节点序号，分别变成了对应的节点对象。</p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">绘制</code> <br/>
分别绘制三种图形元素：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">line，线段，表示连线。</li>
<li style="line-height: 1.6;">circle，圆，表示节点。</li>
<li style="line-height: 1.6;">text，文字，描述节点。</li>
</ul>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加连线 </span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> svg_edges = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;line&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .data(edges)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;line&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;stroke&quot;</span>,<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;#ccc&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;stroke-width&quot;</span>,<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> color = d3.scale.category20();
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加节点 </span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> svg_nodes = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;circle&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .data(nodes)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;circle&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;r&quot;</span>,<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">20</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>,<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d,i</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">         <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> color(i);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .call(force.drag);  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//使得节点能够拖动</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//添加描述节点的文字</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> svg_texts = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;text&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .data(nodes)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;text&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;black&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;dx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">20</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;dy&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">8</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     .text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>)</span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.name;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">     });
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">由于力导向图是不断运动的，每一时刻都在发生更新，因此，必须不断更新节点和连线的位置。还需要设置一个监听器，为tick事件设置监听器即可。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">force.on(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;tick&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;"></span>) </span>{  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 对运动中的每一步进行监听</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 更新连线坐标</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            svg_edges.attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;x1&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.source.x; })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y1&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.source.y; })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;x2&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.target.x; })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y2&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.target.y; });
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//更新节点坐标</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            svg_nodes.attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.x; })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;cy&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.y; });
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//更新文字坐标</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            svg_texts.attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;x&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.x; })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;y&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.y; });
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        });
</div></code></pre>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第十四章 树状图</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;">树状图，<strong style="font-weight: bold; line-height: 1.6;">可表示节点之间的包含与被包含关系。</strong></p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531667378247.png" type="image/png" data-filename="./1531667378247.png" alt="Alt text" longdesc="./1531667378247.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">数据</code> <br/>
初始数据先写在一个 <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">JSON</code> 文件中，再用 D3 来读取。 <br/>
<a href="http://www.runoob.com/json/json-tutorial.html" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">JSON 教程</a></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;中国&quot;</span>,
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;children&quot;</span>:
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">[
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    { 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;浙江&quot;</span> , 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;children&quot;</span>:
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      [
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;杭州&quot;</span> },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;宁波&quot;</span> },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;温州&quot;</span> },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;绍兴&quot;</span> }
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">      ] 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    { 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;广西&quot;</span> , 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;children&quot;</span>:
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        [
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;桂林&quot;</span>,
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;children&quot;</span>:
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            [
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;秀峰区&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;叠彩区&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;象山区&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;七星区&quot;</span>}
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            ]
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;南宁&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;柳州&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;防城港&quot;</span>}
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        ] 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    { 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;黑龙江&quot;</span>,
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;children&quot;</span>:
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        [
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;哈尔滨&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;齐齐哈尔&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;牡丹江&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;大庆&quot;</span>}
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        ] 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    },
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    { 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;新疆&quot;</span> , 
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;children&quot;</span>:
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        [
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;乌鲁木齐&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;克拉玛依&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;吐鲁番&quot;</span>},
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            {<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">&quot;name&quot;</span>:<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;哈密&quot;</span>}
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        ]
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    }
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">]
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">}
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">布局（数据转换）</code> <br/>
定义一个树图布局： <br/>
separation()的参数是function(a,b)，a,b表示两个相邻节点  如果a节点和b节点的父节点是相同的，a和b的间隔是1，否则是2。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> tree = d3.layout.tree()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  .size([width, height<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">-200</span>]) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// size()：设定尺寸，即转换后的各节点的坐标在哪一个范围内。</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  .separation(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">a, b</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> (a.parent == b.parent ? <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span> : <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>); });
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">读取数据</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 读取的文件内容在root中</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">d3.json(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;city_tree.json&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">error, root</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> nodes = tree.nodes(root);  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 计算得到节点数组，保存在变量nodes中</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> links = tree.links(nodes); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 得到连线数组，保存在links中</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">console</span>.log(nodes);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">console</span>.log(links);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">}
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">输出节点的结果： <br/>
nodes 中有各个节点的子节点（children）、深度（depth）、名称（name）、位置（x，y）信息。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531465804338.png" type="image/png" data-filename="./1531465804338.png" alt="Alt text" longdesc="./1531465804338.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
输出连线的结果： <br/>
links 中有连线两端（ source , target ）的节点信息。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531465817857.png" type="image/png" data-filename="./1531465817857.png" alt="Alt text" longdesc="./1531465817857.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/></p>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">绘制</code> <br/>
d3.svg.diagonal() <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">对角线生成器</code>，只需要输入两个顶点坐标，即可生成一条<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">贝塞尔曲线</code>。 <br/>
创建一个对角线生成器： <br/>
projection() 是一个<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">点变换器</code>，默认是 [ d.x , d.y ]，即保持原坐标不变，如果写成 [ d.y , d.x ] ，即是说对任意输入的顶点，都交换 x 和 y 坐标。这里是把<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">由上到下的树</code>改变为<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">横向的树</code>。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> diagonal = d3.svg.diagonal()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">    .projection(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span>(<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{ <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> [d.y, d.x]; });
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">分别绘制三种图形元素：</p>

<ul style="margin-top: 0; margin-bottom: 1.1em; line-height: 1.6;"><li style="line-height: 1.6;">line，线段，表示连线。</li>
<li style="line-height: 1.6;">circle，圆，表示节点。</li>
<li style="line-height: 1.6;">text，文字，描述节点。</li>
</ul>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// line</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> link = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;.link&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                        .data(links)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                        .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                        .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;path&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                        .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;class&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;link&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                        .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;d&quot;</span>, diagonal);  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//使用对角线生成器</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// node包含circel和text</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> node = svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;.node&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .data(nodes)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;g&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;class&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;node&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;transform&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;translate(&quot;</span> + d.y + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;,&quot;</span> + d.x + <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;)&quot;</span>; <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 平移</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            node.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;circle&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;r&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">4.5</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            node.append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;text&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;dx&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.children ? <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">-8</span> : <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">8</span>; <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 如果某节点是叶子节点，则节点文字在圆圈的右边，否则在左边</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;dy&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">3</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .style(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;text-anchor&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.children ? <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;end&quot;</span> : <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;start&quot;</span>; <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 如果某节点是叶子节点，则节点文字在圆圈的右边，否则在左边</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .text(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> d.name;
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                });
</div></code></pre>



<h4 style="font-family: inherit; font-weight: bold; color: inherit; margin-top: 10.5px; margin-bottom: 10.5px; font-size: 20px; margin: 1.2em 0 .6em 0; text-align: start; line-height: 1.6;">第十五章 中国地图</h4>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">GeoJSON</code> 是用于描述地理空间信息的数据格式。GeoJSON 不是一种新的格式，其语法规范是符合 JSON 格式的，只不过对其名称进行了规范，专门用于表示地理信息。</p>



<p style="margin: 0 0 1.1em; line-height: 1.6;"><img src="D3_files/.1531485638681.png" type="image/png" data-filename="./1531485638681.png" alt="Alt text" longdesc="./1531485638681.png" style="border: 0; vertical-align: middle; max-width: 100%;" title=""/> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">数据</code> <br/>
<a href="http://www.ourd3js.com/demo/rm/R-10.0/china.geojson" style="background: transparent; color: #1980e6; text-decoration: none;" target="_blank">china.geojson</a> <br/>
<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">投影函数</code> <br/>
由于 GeoJSON 文件中的地图数据，都是经度和纬度的信息。它们都是三维的，而要在网页上显示的是二维的，所以要设定一个投影函数来转换经度纬度。</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 投影函数</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"> <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> projection = d3.geo.mercator()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">          .center([<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">107</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">31</span>]) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 定地图的中心位置，[107,31] 指的是经度和纬度。</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">          .scale(<span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">850</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 定放大的比例</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">          .translate([width / <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>, height / <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">2</span>]); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 设定平移</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; color: #c7254e; background-color: #f9f2f4; white-space: normal; border-radius: 4px;">地理路径生成器</code> <br/>
生成path 元素的路径值</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 地理路径生成器</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">var</span> path = d3.geo.path()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">       .projection(projection); <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 设定路径生成器的投影函数</span>
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">向服务器请求文件并绘制地图</p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; background-color: rgba(102,128,153,0.05); color: #333; word-wrap: break-word; font-size: .9em; background: #f6f6f6; line-height: 1.6; margin: 0 0 1.1em; padding: 0; border: 0; border-radius: 5px; text-align: start; word-break: break-all;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: inherit; background-color: transparent; white-space: pre-wrap; border-radius: 0; color: #f8f8f2; display: block; overflow-x: auto; background: #23241f; padding: 1.3em 2em;"><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">  <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">//  向服务器请求文件并绘制地图</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">   <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 所有读取到的信息会被放到root中</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        d3.json(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;china.geojson&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">error, root</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">if</span> (error)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">console</span>.error(error);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">console</span>.log(root.features);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;"><div style="line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">            svg.selectAll(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;path&quot;</span>) <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// 每一个&lt;path&gt;代表一个省</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .data(root.features)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .enter()
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .append(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;path&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;stroke&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;#000&quot;</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;stroke-width&quot;</span>, <span style="display: inline; line-height: 1.6; color: #ae81ff; background-color: transparent;">1</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">return</span> color(i);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;d&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    path(d);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">               <span style="display: inline; line-height: 1.6; color: #75715e; background-color: transparent;">// .attr(&quot;d&quot;, path) // 使用地理路径生成器</span>
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .on(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;mouseover&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    d3.select(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                        .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, <span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;yellow&quot;</span>);
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                })
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                .on(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;mouseout&quot;</span>, <span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #66d9ef; background-color: transparent;">function</span> (<span style="display: inline; line-height: 1.6; color: #f8f8f2; background-color: transparent;">d, i</span>) </span>{
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                    d3.select(<span style="display: inline; line-height: 1.6; color: #f92672; background-color: transparent;">this</span>)
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                        .attr(<span style="display: inline; line-height: 1.6; color: #e6db74; background-color: transparent;">&quot;fill&quot;</span>, color(i));
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">                });
</div><div style="min-height: 1.5em; color: inherit; line-height: 1.6; background-color: transparent;">        });
</div></code></pre>

<p style="margin: 0 0 1.1em; line-height: 1.6;">附件：</p></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%23%23D3.js%0A%0A@%5Bd3js%5D%0A%0A%0A---%0A%23%23%23%23%u7B2C%u4E00%u7AE0%20%u7B80%u4ECB%u548C%u5B89%u88C5%0A%60D3%20%u662F%u4EC0%u4E48%60%0A%3ED3%20%u7684%u5168%u79F0%u662F%uFF08Data-Driven%20Documents%uFF09%uFF0C%u987E%u540D%u601D%u4E49%u53EF%u4EE5%u77E5%u9053%u662F%u4E00%u4E2A%u88AB%u6570%u636E%u9A71%u52A8%u7684%u6587%u6863%u3002%u542C%u540D%u5B57%u6709%u70B9%u62BD%u8C61%uFF0C%u8BF4%u7B80%u5355%u4E00%u70B9%uFF0C%u5176%u5B9E%u5C31%u662F%u4E00%u4E2A%20JavaScript%20%u7684%u51FD%u6570%u5E93%uFF0C%u4F7F%u7528%u5B83%u4E3B%u8981%u662F%u7528%u6765%u505A%u6570%u636E%u53EF%u89C6%u5316%u7684%u3002%u5982%u679C%u4F60%u4E0D%u77E5%u9053%u4EC0%u4E48%u662F%20JavaScript%20%uFF0C%u8BF7%u5148%u5B66%u4E60%u4E00%u70B9%20JavaScript%20%u7684%u57FA%u7840%u77E5%u8BC6%u3002%0A%0A%5BW3School%20%u7684%20JavaScript%20%u6559%u7A0B%5D%28http%3A//www.w3school.com.cn/js/%29%0A%0A%0A%60%u4E3A%u4EC0%u4E48%u8981%u6570%u636E%u53EF%u89C6%u5316%60%0A%3E%u73B0%u5728%u6709%u4E00%u7EC4%u6570%u636E%uFF0C%20%5B4%20%uFF0C%2032%20%uFF0C%2015%20%uFF0C%2016%20%uFF0C%2042%20%uFF0C%2025%20%5D%20%uFF0C%u4F60%u80FD%u4E00%u773C%u770B%u51FA%u5B83%u4EEC%u7684%u5927%u5C0F%u5173%u7CFB%u5417%uFF1F%u5F53%u7136%u8FD9%u91CC%u7684%u6570%u636E%u4E0D%u7B97%u591A%uFF0C%u6709%u90A3%u773C%u75BE%u624B%u5FEB%u7684%u5BB6%u4F19%u7AD9%u51FA%u6765%u8BF4%u6211%u80FD%u4E00%u773C%u770B%u51FA%u6765%uFF01%u4F46%u66F4%u76F4%u89C2%u7684%u662F%u7528%u56FE%u5F62%u663E%u793A%uFF0C%u5982%u4E0B%u56FE%uFF1A%0A%3E%21%5BAlt%20text%5D%28./1531382062354.png%29%0A%3E%u901A%u8FC7%u56FE%u5F62%u7684%u663E%u793A%uFF0C%u80FD%u5F88%u6E05%u695A%u5730%u77E5%u9053%u4ED6%u4EEC%u7684%u5927%u5C0F%u5173%u7CFB%u3002%u5F53%u7136%uFF0CD3%20%u80FD%u529B%u8FDC%u4E0D%u6B62%u5982%u6B64%uFF0C%u8FD9%u53EA%u662F%u4E00%u4E2A%u5F88%u5C0F%u7684%u5E94%u7528%u3002%u628A%60%u67AF%u71E5%u4E4F%u5473%u590D%u6742%60%u7684%u6570%u636E%uFF0C%u7528%60%u7B80%u5355%u660E%u4E86%60%u7684%u56FE%u5F62%u8868%u793A%u51FA%u6765%uFF0C%u8FD9%u5C31%u662F%u6570%u636E%u53EF%u89C6%u5316%u3002%0A%0A---%0A%60D3%20%u6709%u591A%u53D7%u6B22%u8FCE%60%0AD3%20%u662F%u4E00%u4E2A%u5F00%u6E90%u9879%u76EE%uFF0C%u4F5C%u8005%u662F%u7EBD%u7EA6%u65F6%u62A5%u7684%u5DE5%u7A0B%u5E08%u3002D3%20%u9879%u76EE%u7684%u4EE3%u7801%u6258%u7BA1%u4E8E%20GitHub%uFF08%u4E00%u4E2A%u5F00%u53D1%u7BA1%u7406%u5E73%u53F0%uFF0C%u76EE%u524D%u5DF2%u7ECF%u662F%u5168%u4E16%u754C%u6700%u6D41%u884C%u7684%u4EE3%u7801%u6258%u7BA1%u5E73%u53F0%uFF0C%u4E91%u96C6%u4E86%u6765%u81EA%u4E16%u754C%u5404%u5730%u7684%u4F18%u79C0%u5DE5%u7A0B%u5E08%uFF09%u3002%0Ahttps%3A//github-ranking.anytao.net/repositories%0A%21%5BAlt%20text%5D%28./1531382281741.png%29%0A%0A%0A---%0A%60%u5982%u4F55%u5B66%u4E60%u548C%u4F7F%u7528%20D3%60%0A%u4EE5%u4E0B%u662F%u51E0%u4E2A%u5B66%u4E60%20D3%20%u7684%u7AD9%u70B9%uFF1A%0A-%20%u5B98%u65B9%u7F51%u7AD9%0Ahttp%3A//d3js.org/%0A%u5305%u542B%u6709%u5F88%u591A%u793A%u4F8B%u548C%20API%uFF0C%u8981%u60F3%u5F97%u5FC3%u5E94%u624B%u7684%u4F7F%u7528%20D3%uFF0C%u719F%u6089%20API%20%u662F%u907F%u4E0D%u5F00%u7684%u3002%0A-%20Mike%20Bostock%20%u7684%u535A%u5BA2%u548C%u4F5C%u54C1%u5C55%u793A%u677F%0Ahttp%3A//bost.ocks.org/mike/%0A-%20Web%20%u6570%u636E%u53EF%u89C6%u5316%u5DE5%u5177%0Ahttps%3A//github.com/jobbole/awesome-javascript-cn%23data-visualization%0A-%20%u53EF%u89C6%u5316%u6280%u672F%u6808%u53CA%u5B66%u4E60%u8BA1%u5212%0A%20https%3A//segmentfault.com/a/1190000010175892%0A-%20API%0Ahttps%3A//github.com/d3/d3/wiki/API--%25E4%25B8%25AD%25E6%2596%2587%25E6%2589%258B%25E5%2586%258C%0A%0A---%0A%60%u5B89%u88C5D3%60%0AD3%20%u662F%u4E00%u4E2A%20JavaScript%20%u51FD%u6570%u5E93%uFF0C%u5E76%u4E0D%u9700%u8981%u901A%u5E38%u6240%u8BF4%u7684%60%u5B89%u88C5%60%u3002%u5B83%u53EA%u6709%u4E00%u4E2A%u6587%u4EF6%uFF0C%u5728%20HTML%20%u4E2D%u5F15%u7528%u5373%u53EF%u3002%u6709%u4E24%u79CD%u65B9%u6CD5%uFF1A%0A%uFF081%uFF09%u4E0B%u8F7D%20D3.js%20%u7684%u6587%u4EF6%0A-%09d3.zip%0A%0A%u89E3%u538B%u540E%uFF0C%u5728%20HTML%20%u6587%u4EF6%u4E2D%u5305%u542B%u76F8%u5173%u7684%20js%20%u6587%u4EF6%u5373%u53EF%u3002%0A%uFF082%uFF09%u76F4%u63A5%u5305%u542B%u7F51%u7EDC%u7684%u94FE%u63A5%0A%60%60%60javascript%0A%3Cscript%20src%3D%22http%3A//d3js.org/d3.v3.min.js%22%20charset%3D%22utf-8%22%3E%3C/script%3E%0A%60%60%60%0A%09%0A%5Bbootsdn%5D%28https%3A//www.bootcdn.cn/%29%0A%u8FD9%u79CD%u65B9%u6CD5%u6BD4%u8F83%u7B80%u5355%uFF0C%u4F46%u8981%u4FDD%u6301%u7F51%u7EDC%u8FDE%u63A5%u6709%u6548%u3002%0A%0A%0A---%0A%60%u5B66%u4E60%20D3%20%u9700%u8981%u4EC0%u4E48%u9884%u5907%u77E5%u8BC6%60%0A%u60F3%u8981%u901A%u8FC7%20D3%20%u6765%u5F00%u542F%u6570%u636E%u53EF%u89C6%u5316%u4E4B%u65C5%u7684%u670B%u53CB%uFF0C%u9700%u8981%u4EC0%u4E48%u9884%u5907%u77E5%u8BC6%u5462%uFF1F%0A-%09HTML%uFF1A%u8D85%u6587%u672C%u6807%u8BB0%u8BED%u8A00%uFF0C%u7528%u4E8E%u8BBE%u5B9A%u7F51%u9875%u7684%u5185%u5BB9%0A-%20CSS%uFF1A%u5C42%u53E0%u6837%u5F0F%u8868%uFF0C%u7528%u4E8E%u8BBE%u5B9A%u7F51%u9875%u7684%u6837%u5F0F%0A-%09JavaScript%uFF1A%u4E00%u79CD%u76F4%u8BD1%u5F0F%u811A%u672C%u8BED%u8A00%uFF0C%u7528%u4E8E%u8BBE%u5B9A%u7F51%u9875%u7684%u884C%u4E3A%0A-%09DOM%uFF1A%u6587%u6863%u5BF9%u8C61%u6A21%u578B%uFF0C%u7528%u4E8E%u4FEE%u6539%u6587%u6863%u7684%u5185%u5BB9%u548C%u7ED3%u6784%0A-%09SVG%uFF1A%u53EF%u7F29%u653E%u77E2%u91CF%u56FE%u5F62%uFF0C%u7528%u4E8E%u7ED8%u5236%u53EF%u89C6%u5316%u7684%u56FE%u5F62%0A%0A%5BW3C%u83DC%u9E1F%u6559%u7A0B%5D%28http%3A//www.runoob.com/%29%0A%0A%60%u9700%u8981%u4EC0%u4E48%u5DE5%u5177%60%0A%3E%u5236%u4F5C%u7F51%u9875%u5E38%u7528%u7684%u5DE5%u5177%u5373%u53EF%u3002%0A%u8BB0%u4E8B%u672C%u8F6F%u4EF6%uFF1ANotepad++%u3001Editplus%u3001Sublime%20Text%u3001%60webstrom%60%20%u7B49%uFF0C%u9009%u62E9%u81EA%u5DF1%u559C%u6B22%u7684%u5373%u53EF%u3002%0A%u6D4F%u89C8%u5668%uFF1AIE9%20%u4EE5%u4E0A%u3001Firefox%u3001Chrome%20%u7B49%uFF0C%u63A8%u8350%u7528%20%60Chrome%60%0A%u670D%u52A1%u5668%u8F6F%u4EF6%uFF1AApache%u3001Tomcat%20%u7B49%0A%u5176%u4E2D%uFF0C%u670D%u52A1%u5668%u8F6F%u4EF6%u53EF%u80FD%u4E0D%u662F%u5FC5%u987B%u7684%uFF0C%u4E0D%u8FC7%20D3%20%u4E2D%u6709%u4E9B%u51FD%u6570%u9700%u8981%u5C06%20HTML%20%u6587%u4EF6%u653E%u7F6E%u4E8E%u670D%u52A1%u5668%u76EE%u5F55%u4E0B%uFF0C%u624D%u80FD%u6B63%u5E38%u4F7F%u7528%2C%u6BD4%u5982d3.csv%u3002%0A%0A%0A---%0A%23%23%23%23%u7B2C%u4E8C%u7AE0%20%u7B2C%u4E00%u4E2A%u7A0B%u5E8F%20%0A%u9009%u62E9%u5143%u7D20%u548C%u7ED1%u5B9A%u6570%u636E%u662F%20D3%20%u6700%u57FA%u7840%u7684%u5185%u5BB9%uFF0C%u672C%u6587%u5C06%u5BF9%u5176%u8FDB%u884C%u4E00%u4E2A%u7B80%u5355%u7684%u4ECB%u7ECD%u3002%0A%21%5BAlt%20text%5D%28./1531383200008.png%29%0A%0A---%0A%60%u5982%u4F55%u9009%u62E9%u5143%u7D20%60%0A%u5728%20D3%20%u4E2D%uFF0C%u7528%u4E8E%u9009%u62E9%u5143%u7D20%u7684%u51FD%u6570%u6709%u4E24%u4E2A%uFF1A%0A-%09d3.select%28%29%uFF1A%u662F%u9009%u62E9%u6240%u6709%u6307%u5B9A%u5143%u7D20%u7684%60%u7B2C%u4E00%u4E2A%60%0A-%09d3.selectAll%28%29%uFF1A%u662F%u9009%u62E9%u6307%u5B9A%u5143%u7D20%u7684%60%u5168%u90E8%60%0A%0A%u8FD9%u4E24%u4E2A%u51FD%u6570%u8FD4%u56DE%u7684%u7ED3%u679C%u79F0%u4E3A%u9009%u62E9%u96C6%u3002%0A%u4F8B%u5982%uFF0C%u9009%u62E9%u96C6%u7684%u5E38%u89C1%u7528%u6CD5%u5982%u4E0B%u3002%0A%60%60%60javascript%0Avar%20body%20%3D%20d3.select%28%22body%22%29%3B%20//%u9009%u62E9%u6587%u6863%u4E2D%u7684body%u5143%u7D20%0Avar%20p1%20%3D%20body.select%28%22p%22%29%3B%20%20%20%20%20%20//%u9009%u62E9body%u4E2D%u7684%u7B2C%u4E00%u4E2Ap%u5143%u7D20%0Avar%20p%20%3D%20body.selectAll%28%22p%22%29%3B%20%20%20%20//%u9009%u62E9body%u4E2D%u7684%u6240%u6709p%u5143%u7D20%0Avar%20svg%20%3D%20body.select%28%22svg%22%29%3B%20%20%20//%u9009%u62E9body%u4E2D%u7684svg%u5143%u7D20%0Avar%20rects%20%3D%20svg.selectAll%28%22rect%22%29%3B%20%20//%u9009%u62E9svg%u4E2D%u6240%u6709%u7684react%u5143%u7D20%0A%60%60%60%0A%0A%0A%60%u5982%u4F55%u7ED1%u5B9A%u6570%u636E%60%0AD3%20%u6709%u4E00%u4E2A%u5F88%u72EC%u7279%u7684%u529F%u80FD%uFF1A%u80FD%u5C06%60%u6570%u636E%60%u7ED1%u5B9A%u5230%60%20DOM%20%60%u4E0A%uFF0C%u4E5F%u5C31%u662F%u7ED1%u5B9A%u5230%u6587%u6863%u4E0A%u3002%u8FD9%u4E48%u8BF4%u53EF%u80FD%u4E0D%u597D%u7406%u89E3%uFF0C%u4F8B%u5982%u7F51%u9875%u4E2D%u6709%u6BB5%u843D%u5143%u7D20%20p%20%u548C%u4E00%u4E2A%u6574%u6570%205%uFF0C%u4E8E%u662F%u53EF%u4EE5%u5C06%u6574%u6570%205%20%u4E0E%20p%20%u7ED1%u5B9A%u5230%u4E00%u8D77%u3002%u7ED1%u5B9A%u4E4B%u540E%uFF0C%u5F53%u9700%u8981%u4F9D%u9760%u8FD9%u4E2A%u6570%u636E%u624D%u64CD%u4F5C%u5143%u7D20%u7684%u65F6%u5019%uFF0C%u4F1A%u5F88%u65B9%u4FBF%u3002%0AD3%20%u4E2D%u662F%u901A%u8FC7%u4EE5%u4E0B%u4E24%u4E2A%u51FD%u6570%u6765%u7ED1%u5B9A%u6570%u636E%u7684%uFF1A%0A-%20datum%28%29%uFF1A%u7ED1%u5B9A%60%u4E00%u4E2A%u6570%u636E%60%u5230%u9009%u62E9%u96C6%u4E0A%0A-%20data%28%29%uFF1A%u7ED1%u5B9A%60%u4E00%u4E2A%u6570%u7EC4%60%u5230%u9009%u62E9%u96C6%u4E0A%uFF0C%u6570%u7EC4%u7684%u5404%u9879%u503C%u5206%u522B%u4E0E%u9009%u62E9%u96C6%u7684%u5404%u5143%u7D20%u7ED1%u5B9A%0A%60%60%60htmlbars%0A%3Cp%3EApple%3C/p%3E%0A%3Cp%3EPear%3C/p%3E%0A%3Cp%3EBanana%3C/p%3E%0A%60%60%60%0A%0Adatum%28%29%0A%u5047%u8BBE%u6709%u4E00%u5B57%u7B26%u4E32%20China%uFF0C%u8981%u5C06%u6B64%u5B57%u7B26%u4E32%u5206%u522B%u4E0E%u4E09%u4E2A%u6BB5%u843D%u5143%u7D20%u7ED1%u5B9A%uFF0C%u4EE3%u7801%u5982%u4E0B%3A%0A%60%60%60javascript%0A%09%20var%20str%20%3D%20%22China%22%3B%0A%20%20%20%20%20d3.select%28%22body%22%29.selectAll%28%22p%22%29.datum%28str%29.text%28function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%22%u7B2C%20%22%20+%20i%20+%20%22%20%u4E2A%u5143%u7D20%u7ED1%u5B9A%u7684%u6570%u636E%u662F%20%22%20+%20d%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%60%60%60%0A%u5728%u4E0A%u9762%u7528%u5230%u4E86%u4E00%u4E2A%u65E0%u540D%u51FD%u6570%20function%28d%2C%20i%29%u3002%u5176%u5305%u542B%u4E24%u4E2A%u53C2%u6570%uFF0C%u5176%u4E2D%uFF1A%0A-%09d%20%u4EE3%u8868%u6570%u636E%uFF0C%u4E5F%u5C31%u662F%u4E0E%u67D0%u5143%u7D20%u7ED1%u5B9A%u7684%u6570%u636E%u3002%0A-%09i%20%u4EE3%u8868%u7D22%u5F15%uFF0C%u4EE3%u8868%u6570%u636E%u7684%u7D22%u5F15%u53F7%uFF0C%u4ECE%200%20%u5F00%u59CB%u3002%0A%0Adata%28%29%0A%u6709%u4E00%u4E2A%u6570%u7EC4%uFF0C%u63A5%u4E0B%u6765%u8981%u5206%u522B%u5C06%u6570%u7EC4%u7684%u5404%u5143%u7D20%u7ED1%u5B9A%u5230%u4E09%u4E2A%u6BB5%u843D%u5143%u7D20%u4E0A%u3002%0A%60%60%60javascript%0A%20%20%20var%20dataset%20%3D%20%5B%22I%20like%20dog%22%2C%20%22I%20like%20cat%22%2C%20%22I%20like%20snake%22%5D%3B%0A%20%20%20d3.select%28%22body%22%29.selectAll%28%22p%22%29.data%28dataset%29%0A%20%20%20%20%20%20.text%28function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20d%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%60%60%60%0A%0A---%0A%23%23%23%23%u7B2C%u4E09%u7AE0%20%u9009%u62E9%u3001%u63D2%u5165%u3001%u5220%u9664%u5143%u7D20%0A%21%5BAlt%20text%5D%28./1531396536606.png%29%0A%60%u9009%u62E9%u7279%u5B9A%u7684%u5143%u7D20%60%0A%u9009%u62E9%u7B2C%u4E00%u4E2Ap%u5143%u7D20%0A%60%60%60javascript%0A//%20%20%u9009%u62E9%u7B2C%u4E00%u4E2Ap%u5143%u7D20%0A%20d3.select%28%22body%22%29.select%28%22p%22%29.style%28%22color%22%2C%20%22red%22%29%0A%60%60%60%0A%u9009%u62E9%u4E09%u4E2A%20p%20%u5143%u7D20%0A%60%60%60javascript%0A%20//%20%u9009%u62E9%u4E09%u4E2A%20p%20%u5143%u7D20%0A%20%20%20%20d3.select%28%22body%22%29.selectAll%28%22p%22%29.style%28%22color%22%2C%20%22red%22%29%3B%0A%60%60%60%0A%u9009%u62E9%u7B2C%u4E8C%u4E2A%20p%20%u5143%u7D20%0A%60%60%60javascript%0A//%20%u6709%u4E0D%u5C11%u65B9%u6CD5%uFF0C%u4E00%u79CD%u6BD4%u8F83%u7B80%u5355%u7684%u662F%u7ED9%u7B2C%u4E8C%u4E2A%u5143%u7D20%u6DFB%u52A0%u4E00%u4E2A%20id%20%u53F7%u3002%0A//%20%u7136%u540E%uFF0C%u4F7F%u7528%20select%20%u9009%u62E9%u5143%u7D20%uFF0C%u6CE8%u610F%u53C2%u6570%u4E2D%20id%20%u540D%u79F0%u524D%u8981%u52A0%20%23%20%u53F7%0A//%20%u9009%u62E9%u7B2C%u4E8C%u4E2A%20p%20%u5143%u7D20%0A%20%20%20d3.select%28%22body%22%29.select%28%22%23myid%22%29.style%28%22color%22%2C%20%22red%22%29%3B%0A%60%60%60%0A%u9009%u62E9%u540E%u4E24%u4E2A%20p%20%u5143%u7D20%0A%60%60%60javascript%0A//%20%u7ED9%u540E%u4E24%u4E2A%u5143%u7D20%u6DFB%u52A0%20class%20%u9009%u62E9%u540E%u4E24%u4E2A%20p%20%u5143%u7D20%0A%20%20%20d3.select%28%22body%22%29.selectAll%28%22.myclass%22%29.style%28%22color%22%2C%20%22red%22%29%3B%0A%60%60%60%0A%u5176%u4ED6%u65B9%u6CD5%0A%60%60%60javascript%0A//%20%u8FD0%u7528%20function%28d%2C%20i%29%2C%u53C2%u6570%20i%20%u662F%u4EE3%u8868%u7D22%u5F15%u53F7%u7684%uFF0C%u4E8E%u662F%u4FBF%u53EF%u4EE5%u7528%u6761%u4EF6%u5224%u5B9A%u8BED%u53E5%u6765%u6307%u5B9A%u6267%u884C%u7684%u5143%u7D20%u3002%0Ad3.select%28%22%20body%22%29.selectAll%28%22p%22%29.style%28%22color%22%2Cfunction%28d%2Ci%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%28i%3D%3D0%29%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%22red%22%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%29%0A%60%60%60%0A%0A%60%u63D2%u5165%u5143%u7D20%60%0A%u63D2%u5165%u5143%u7D20%u6D89%u53CA%u7684%u51FD%u6570%u6709%u4E24%u4E2A%uFF1A%0A-%09append%28%29%uFF1A%u5728%u9009%u62E9%u96C6%60%u672B%u5C3E%60%u63D2%u5165%u5143%u7D20%0A-%09insert%28%29%uFF1A%u5728%u9009%u62E9%u96C6%60%u524D%u9762%60%u63D2%u5165%u5143%u7D20%0A%0Aappend%0A%60%60%60javascript%0A%20//%20append%28%29%0A%20%20%20%20%20%20%20%20body.append%28%22p%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.text%28%22append%20p%20element%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.style%28%22color%22%2C%22green%22%29%0A%60%60%60%0A%0Ainsert%0A%60%60%60javascript%0A//%20insert%28%29%0A%20%20%20%20%20%20%20%20//%20%u5728%20body%20%u4E2D%20id%20%u4E3A%20myid%20%u7684%u5143%u7D20%u524D%u6DFB%u52A0%u4E00%u4E2A%u6BB5%u843D%u5143%u7D20%u3002%0A%20%20%20%20%20%20%20%20body.insert%28%22p%22%2C%20%22%23myid%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.text%28%22insert%20p%20element%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.style%28%22color%22%2C%22blue%22%29%0A%60%60%60%0A%0A%60%u5220%u9664%u5143%u7D20%60%0A-%09%20remove%0A%60%60%60javascript%0Avar%20p%20%3D%20body.select%28%22%23myid%22%29%3B%0Ap.remove%28%29%3B%0A%60%60%60%0A%0A---%0A%23%23%23%23%u7B2C%u56DB%u7AE0%20%u7ED8%u5236%u77E9%u5F62%0A%21%5BAlt%20text%5D%28./1531639129775.png%29%0A%0A%60%u753B%u5E03%60%0A%u524D%u9762%u7684%u5904%u7406%u5BF9%u8C61%u90FD%u662F%20HTML%20%u7684%u6587%u5B57%uFF0C%u6CA1%u6709%u6D89%u53CA%u56FE%u5F62%u7684%u5236%u4F5C%u3002%0A%u8981%u7ED8%u56FE%uFF0C%u9996%u8981%u9700%u8981%u7684%u662F%u4E00%u5757%u7ED8%u56FE%u7684%60%u201C%u753B%u5E03%u201D%60%u3002%0AHTML%205%20%u63D0%u4F9B%u4E24%u79CD%u5F3A%u6709%u529B%u7684%u201C%u753B%u5E03%u201D%3A%20SVG%20%u548C%20Canvas%u3002%0A%60SVG%20%u662F%u4EC0%u4E48%60%0ASVG%uFF0C%u6307%u53EF%u7F29%u653E%u77E2%u91CF%u56FE%u5F62%uFF08Scalable%20Vector%20Graphics%uFF09%uFF0C%u662F%u7528%u4E8E%u63CF%u8FF0%u4E8C%u7EF4%u77E2%u91CF%u56FE%u5F62%u7684%u4E00%u79CD%u56FE%u5F62%u683C%u5F0F%uFF0C%u662F%u7531%u4E07%u7EF4%u7F51%u8054%u76DF%u5236%u5B9A%u7684%u5F00%u653E%u6807%u51C6%u3002%20SVG%20%u4F7F%u7528%20XML%20%u683C%u5F0F%u6765%u5B9A%u4E49%u56FE%u5F62%uFF0C%u9664%u4E86%20IE8%20%u4E4B%u524D%u7684%u7248%u672C%u5916%uFF0C%u7EDD%u5927%u90E8%u5206%u6D4F%u89C8%u5668%u90FD%u652F%u6301%20SVG%uFF0C%u53EF%u5C06%20SVG%20%u6587%u672C%u76F4%u63A5%u5D4C%u5165%20HTML%20%u4E2D%u663E%u793A%u3002%0ASVG%20%u6709%u5982%u4E0B%u7279%u70B9%uFF1A%0A-%09SVG%20%u7ED8%u5236%u7684%u662F%u77E2%u91CF%u56FE%uFF0C%u56E0%u6B64%u5BF9%u56FE%u50CF%u8FDB%u884C%u653E%u5927%60%u4E0D%u4F1A%u5931%u771F%60%u3002%0A-%09%u57FA%u4E8E%20XML%uFF0C%u53EF%u4EE5%u4E3A%u6BCF%u4E2A%u5143%u7D20%u6DFB%u52A0%20JavaScript%20%60%u4E8B%u4EF6%u5904%u7406%u5668%60%u3002%0A-%09%u6BCF%u4E2A%u56FE%u5F62%u5747%u89C6%u4E3A%60%u5BF9%u8C61%60%uFF0C%u66F4%u6539%u5BF9%u8C61%u7684%u5C5E%u6027%uFF0C%u56FE%u5F62%u4E5F%u4F1A%u6539%u53D8%u3002%0A-%09%u4E0D%u9002%u5408%u6E38%u620F%u5E94%u7528%0A%0A%5BSVG%20%u6559%u7A0B%5D%28http%3A//www.runoob.com/svg/svg-tutorial.html%29%0A-%09%u77E9%u5F62%20%0A-%09%u5706%u5F62%20%0A-%09%u692D%u5706%20%0A-%09%u7EBF%20%0A-%09%u6298%u7EBF%20%0A-%09%u591A%u8FB9%u5F62%20%0A-%09%u8DEF%u5F84%0A%0A%u5728%20SVG%20%u4E2D%uFF0Cx%20%u8F74%u7684%u6B63%u65B9%u5411%u662F%u6C34%u5E73%u5411%u53F3%uFF0Cy%20%u8F74%u7684%u6B63%u65B9%u5411%u662F%u5782%u76F4%u5411%u4E0B%u7684%u3002%0A%60base%60%0A%60%60%60xml%0A%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%22600%22%20height%3D%22600%22%20version%3D%221.1%22%3E%0A%20%20%20%20%3C%21--%20%u77E9%u5F62%20--%3E%0A%20%20%20%20%3Crect%20width%3D%22200%22%20height%3D%22100%22%20x%3D%2220%22%20y%3D%2220%22%20style%3D%22fill%3Ared%3Bstroke%3Ablue%3Bstroke-width%3A4%22/%3E%0A%20%20%20%20%3C%21--%20rx%20%u548C%20ry%20%u5C5E%u6027%u53EF%u4F7F%u77E9%u5F62%u4EA7%u751F%u5706%u89D2%20--%3E%0A%20%20%20%20%3Crect%20width%3D%22200%22%20height%3D%22100%22%20x%3D%22250%22%20y%3D%2220%22%20rx%3D%2220%22%20ry%3D%2210%22%20style%3D%22fill%3Ared%3Bstroke%3Ablue%3Bstroke-width%3A4%22/%3E%0A%20%20%20%20%3C%21--%20%u5706%20--%3E%0A%20%20%20%20%3Ccircle%20cx%3D%22100%22%20cy%3D%22280%22%20r%3D%2280%22%20style%3D%22fill%3Ayellow%22/%3E%0A%20%20%20%20%3C%21--%20%u692D%u5706%20--%3E%0A%20%20%20%20%3C%21--%20RX%u5C5E%u6027%u5B9A%u4E49%u7684%u6C34%u5E73%u534A%u5F84%20--%3E%0A%20%20%20%20%3C%21--%20RY%u5C5E%u6027%u5B9A%u4E49%u7684%u5782%u76F4%u534A%u5F84%20--%3E%0A%20%20%20%20%3Cellipse%20cx%3D%22330%22%20cy%3D%22280%22%20rx%3D%22100%22%20ry%3D%2280%22%20style%3D%22fill%3Ayellow%22/%3E%0A%20%20%20%20%3C%21--%20%u76F4%u7EBF%20%20--%3E%0A%20%20%20%20%3Cline%20x1%3D%220%22%20x2%3D%22600%22%20y1%3D%220%22%20y2%3D%22360%22%20style%3D%22stroke%3A%23000%3Bstroke-width%3A4%22/%3E%0A%20%20%20%20%3C%21--%20%u591A%u8FB9%u5F62%20--%3E%0A%20%20%20%20%3C%21--%20points%20%u5C5E%u6027%u5B9A%u4E49%u591A%u8FB9%u5F62%u6BCF%u4E2A%u89D2%u7684%20x%20%u548C%20y%20%u5750%u6807%20--%3E%0A%20%20%20%20%3Cpolygon%20points%3D%22100%2C20%2020%2C90%2020%2C200%22%20style%3D%22fill%3Agreen%3Bstroke%3Aorange%3Bstroke-width%3A4%22/%3E%0A%20%20%20%20%3C%21--%20%u66F2%u7EBF%20--%3E%0A%20%20%20%20%3Cpolyline%20points%3D%22100%2C20%2020%2C90%2020%2C200%22%20style%3D%22fill%3Agreen%3Bstroke%3Aorange%3Bstroke-width%3A4%22%20transform%3D%22translate%28100%2C0%29%22/%3E%0A%3C/svg%3E%0A%60%60%60%0A%60path%60%0A%u7ED9%u51FA%u4E00%u4E2A%u5750%u6807%u70B9%uFF0C%u5728%u5750%u6807%u70B9%u524D%u9762%u6DFB%u52A0%u4E00%u4E2A%u82F1%u6587%u5B57%u6BCD%uFF0C%u8868%u793A%u5982%u4F55%u8FD0%u52A8%u5230%u6B64%u5750%u6807%u70B9%u3002%0A%60%60%60xml%0A%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20version%3D%221.1%22%3E%0A%20%20%20%20%3Cpath%20d%3D%22M150%200%20L75%20200%20L225%20200%20Z%22%20/%3E%0A%3C/svg%3E%0A%60%60%60%0A%0A%0A%60%u6DFB%u52A0%u753B%u5E03%60%0A%u4F7F%u7528%20D3%20%u5728%20body%20%u5143%u7D20%u4E2D%u6DFB%u52A0%20svg%20%u7684%u4EE3%u7801%u5982%u4E0B%u3002%0A%60%60%60javascript%0Avar%20width%20%3D%20300%3B%20%20//%u753B%u5E03%u7684%u5BBD%u5EA6%0Avar%20height%20%3D%20300%3B%20%20%20//%u753B%u5E03%u7684%u9AD8%u5EA6%0A%0Avar%20svg%20%3D%20d3.select%28%22body%22%29%20%20%20%20%20//%u9009%u62E9%u6587%u6863%u4E2D%u7684body%u5143%u7D20%0A%20%20%20%20.append%28%22svg%22%29%20%20%20%20%20%20%20%20%20%20//%u6DFB%u52A0%u4E00%u4E2Asvg%u5143%u7D20%0A%20%20%20%20.attr%28%22width%22%2C%20width%29%20%20%20%20%20%20%20//%u8BBE%u5B9A%u5BBD%u5EA6%0A%20%20%20%20.attr%28%22height%22%2C%20height%29%3B%20%20%20%20//%u8BBE%u5B9A%u9AD8%u5EA6%0A%60%60%60%0A%60%u7ED8%u5236%u77E9%u5F62%60%0A%0A%0A%u5728%20SVG%20%u4E2D%uFF0C%u77E9%u5F62%u7684%u5143%u7D20%u6807%u7B7E%u662F%20rect%0A%3Ex%uFF1A%u77E9%u5F62%u5DE6%u4E0A%u89D2%u7684%20x%20%u5750%u6807%0Ay%uFF1A%u77E9%u5F62%u5DE6%u4E0A%u89D2%u7684%20y%20%u5750%u6807%0Awidth%uFF1A%u77E9%u5F62%u7684%u5BBD%u5EA6%0Aheight%uFF1A%u77E9%u5F62%u7684%u9AD8%u5EA6%0A%0A%0A%60%60%60javascript%0A%09%09var%20dataset%20%3D%20%5B250%2C%20210%2C%20170%2C%20130%2C%2090%5D%3B%20%20//%u6570%u636E%uFF08%u8868%u793A%u77E9%u5F62%u7684%u5BBD%u5EA6%uFF09%0A%20%20%20%20%20%20%20%20var%20rectHeight%20%3D%2025%3B%20%20%20//%u6BCF%u4E2A%u77E9%u5F62%u6240%u5360%u7684%u50CF%u7D20%u9AD8%u5EA6%28%u5305%u62EC%u7A7A%u767D%29%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20svg.selectAll%28%22rect%22%29%20//%20%u9009%u62E9svg%u5185%u6240%u6709%u7684%u77E9%u5F62%0A%20%20%20%20%20%20%20%20%20%20%20%20.data%28dataset%29%20//%20%u7ED1%u5B9A%u6570%u7EC4%0A%20%20%20%20%20%20%20%20%20%20%20%20.enter%28%29%20%20//%20%u6307%u5B9A%u9009%u62E9%u96C6%u7684enter%u90E8%u5206%0A%20%20%20%20%20%20%20%20%20%20%20%20.append%28%22rect%22%29%20//%20%u6DFB%u52A0%u8DB3%u591F%u6570%u91CF%u7684%u77E9%u5F62%u5143%u7D20%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22x%22%2C%2020%29%20//%20%u5206%u522B%u7ED9%u5404%u5143%u7D20%u7684%u5C5E%u6027%u8D4B%u503C%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22y%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20i%20*%20rectHeight%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22width%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20d%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22height%22%2C%20rectHeight%20-%202%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22fill%22%2C%20%22steelblue%22%29%3B%0A%60%60%60%0A%u4E0B%u9762%u8FD9%u6BB5%u4EE3%u7801%u4EE5%u540E%u4F1A%u5E38%u5E38%u51FA%u73B0%u5728%20D3%20%u7684%u4EE3%u7801%u4E2D%uFF0C%u8BF7%u52A1%u5FC5%u7262%u8BB0%u3002%0A%u5F53%u6709%u6570%u636E%uFF0C%u800C%u6CA1%u6709%u8DB3%u591F%u56FE%u5F62%u5143%u7D20%u7684%u65F6%u5019%uFF0C%u4F7F%u7528%u6B64%u65B9%u6CD5%u53EF%u4EE5%u6DFB%u52A0%u8DB3%u591F%u7684%u5143%u7D20%u3002%0A%60%60%60javascript%0Asvg.selectAll%28%22rect%22%29%20%20%20//%u9009%u62E9svg%u5185%u6240%u6709%u7684%u77E9%u5F62%0A%20%20%20%20.data%28dataset%29%20%20//%u7ED1%u5B9A%u6570%u7EC4%0A%20%20%20%20.enter%28%29%20%20%20%20%20%20%20%20//%u6307%u5B9A%u9009%u62E9%u96C6%u7684enter%u90E8%u5206%0A%20%20%20%20.append%28%22rect%22%29%20//%u6DFB%u52A0%u8DB3%u591F%u6570%u91CF%u7684%u77E9%u5F62%u5143%u7D20%0A%60%60%60%0A%0A%0A%23%23%23%23%u7B2C%u4E94%u7AE0%20%u6BD4%u4F8B%u5C3A%u7684%u4F7F%u7528%0A%u4E0A%u4E00%u7AE0%u91CC%u66FE%u7ECF%u63D0%u5230%u8FC7%u76F4%u63A5%u7528%u6570%u503C%u7684%u5927%u5C0F%u6765%u4EE3%u8868%u50CF%u7D20%u4E0D%u662F%u4E00%u79CD%u597D%u65B9%u6CD5%uFF0C%u672C%u7AE0%u6B63%u662F%u8981%u89E3%u51B3%u6B64%u95EE%u9898%u3002%0A%21%5BAlt%20text%5D%28./1531400578145.png%29%0A%60%u4E3A%u4EC0%u4E48%u9700%u8981%u6BD4%u4F8B%u5C3A%60%0A%3E%u524D%u9762%u5236%u4F5C%u4E86%u4E00%u4E2A%u67F1%u5F62%u56FE%uFF0C%u5F53%u65F6%u6709%u4E00%u4E2A%u6570%u7EC4%uFF1A%0Avar%20dataset%20%3D%20%5B%20250%20%2C%20210%20%2C%20170%20%2C%20130%20%2C%2090%20%5D%3B%0A%u7ED8%u56FE%u65F6%uFF0C%u76F4%u63A5%u4F7F%u7528%20250%20%u7ED9%u77E9%u5F62%u7684%u5BBD%u5EA6%u8D4B%u503C%uFF0C%u5373%u77E9%u5F62%u7684%u5BBD%u5EA6%u5C31%u662F%20250%20%u4E2A%u50CF%u7D20%u3002%0A%u6B64%u65B9%u5F0F%u975E%u5E38%u5177%u6709%u5C40%u9650%u6027%uFF0C%u5982%u679C%u6570%u503C%60%u8FC7%u5927%60%u6216%60%u8FC7%u5C0F%60%uFF0C%u4F8B%u5982%uFF1A%0Avar%20dataset_1%20%3D%20%5B%202.5%20%2C%202.1%20%2C%201.7%20%2C%201.3%20%2C%200.9%20%5D%3B%0Avar%20dataset_2%20%3D%20%5B%202500%2C%202100%2C%201700%2C%201300%2C%20900%20%5D%3B%0A%u5BF9%u4EE5%u4E0A%u4E24%u4E2A%u6570%u7EC4%uFF0C%u7EDD%u4E0D%u53EF%u80FD%u7528%202.5%20%u4E2A%u50CF%u7D20%u6765%u4EE3%u8868%u77E9%u5F62%u7684%u5BBD%u5EA6%uFF0C%u90A3%u6837%u6839%u672C%u770B%u4E0D%u89C1%uFF1B%u4E5F%u4E0D%u53EF%u80FD%u7528%202500%20%u4E2A%u50CF%u7D20%u6765%u4EE3%u8868%u77E9%u5F62%u7684%u5BBD%u5EA6%uFF0C%u56E0%u4E3A%u753B%u5E03%u6CA1%u6709%u90A3%u4E48%u957F%u3002%0A**%u5C06%u67D0%u4E00%u533A%u57DF%u7684%u503C%u6620%u5C04%u5230%u53E6%u4E00%u533A%u57DF%uFF0C%u5176%u5927%u5C0F%u5173%u7CFB%u4E0D%u53D8**%0A%0A%60%u6709%u54EA%u4E9B%u6BD4%u4F8B%u5C3A%60%0A%u6BD4%u4F8B%u5C3A%uFF0C%u5F88%u50CF%u6570%u5B66%u4E2D%u7684%u51FD%u6570%u3002%u5BF9%u4E8Ey%3Df%28x%29%uFF0C%u5F53%20x%20%u7684%u503C%u786E%u5B9A%u65F6%uFF0Cy%20%u7684%u503C%u4E5F%u5C31%u786E%u5B9A%u4E86%u3002%0A%u5728%u6570%u5B66%u4E2D%uFF0Cx%20%u7684%u8303%u56F4%u88AB%u79F0%u4E3A%u5B9A%u4E49%u57DF%uFF0Cy%20%u7684%u8303%u56F4%u88AB%u79F0%u4E3A%u503C%u57DF%u3002%0AD3%20%u7684%u6BD4%u4F8B%u5C3A%u4E2D%u5206%u522B%u88AB%u79F0%u4E3A%20domain%20%u548C%20range%uFF0C%u53EA%u9700%u8981%u6307%u5B9A%20domain%20%u548C%20range%20%u7684%u8303%u56F4%uFF0C%u5C31%u53EF%u4EE5%u5B9A%u4E49%u4E00%u4E2A%u6BD4%u4F8B%u5C3A%u4E86%u3002%0AD3%20%u63D0%u4F9B%u4E86%u591A%u79CD%u6BD4%u4F8B%u5C3A%uFF0C%u4E0B%u9762%u4ECB%u7ECD%u6700%u5E38%u7528%u7684%u4E24%u79CD%u3002%0A%0A%60%u7EBF%u6027%u6BD4%u4F8B%u5C3A%60%0A%u7EBF%u6027%u6BD4%u4F8B%u5C3A%uFF0C%u80FD%u5C06%u4E00%u4E2A%u8FDE%u7EED%u7684%u533A%u95F4%uFF0C%u6620%u5C04%u5230%u53E6%u4E00%u533A%u95F4%u3002%0Ay%3D%20kx%20+%20b%0A**%u5C06%20dataset%20%u4E2D%u6700%u5C0F%u7684%u503C%uFF0C%u6620%u5C04%u6210%200%uFF1B%u5C06%u6700%u5927%u7684%u503C%uFF0C%u6620%u5C04%u6210%20300%u3002**%0A%60%60%60javascript%0A%20var%20dataset%20%3D%20%5B1.2%2C%202.3%2C%200.9%2C%201.5%2C%203.3%5D%3B%0A%0A%20%20%20%20%20%20%20%20var%20min%20%3D%20d3.min%28dataset%29%3B%20//%20%u6C42%u6570%u7EC4%u7684%u6700%u5C0F%u503C%0A%20%20%20%20%20%20%20%20var%20max%20%3D%20d3.max%28dataset%29%3B%20//%20%u6C42%u6570%u7EC4%u7684%u6700%u5927%u503C%0A%0A%20%20%20%20%20%20%20%20var%20linear%20%3D%20d3.scale.linear%28%29%20//%20%u8FD4%u56DE%u4E00%u4E2A%u7EBF%u6027%u6BD4%u4F8B%u5C3A%0A%20%20%20%20%20%20%20%20%20%20%20%20.domain%28%5Bmin%2C%20max%5D%29%20//%20%u5B9A%u4E49%u57DF%0A%20%20%20%20%20%20%20%20%20%20%20%20.range%28%5B0%2C%20300%5D%29%3B%20//%20%u503C%u57DF%0A%0A%20%20%20%20%20%20%20%20linear%280.9%29%3B%20%20%20%20//%u8FD4%u56DE%200%0A%20%20%20%20%20%20%20%20linear%282.3%29%3B%20%20%20%20//%u8FD4%u56DE%20175%0A%20%20%20%20%20%20%20%20linear%283.3%29%3B%20%20%20%20//%u8FD4%u56DE%20300%0A%60%60%60%0A%0A%60%u5E8F%u6570%u6BD4%u4F8B%u5C3A%60%0A%u6709%u65F6%u5019%uFF0C%u5B9A%u4E49%u57DF%u548C%u503C%u57DF%u4E0D%u4E00%u5B9A%u662F%u8FDE%u7EED%u7684%u3002%u4F8B%u5982%uFF0C%u6709%u4E24%u4E2A%u6570%u7EC4%uFF1A%0A%60%60%60javascript%0Avar%20index%20%3D%20%5B0%2C%201%2C%202%2C%203%2C%204%5D%3B%0Avar%20color%20%3D%20%5B%22red%22%2C%20%22blue%22%2C%20%22green%22%2C%20%22yellow%22%2C%20%22black%22%5D%3B%0A%60%60%60%0A%u89C4%u5B9A0%20%u5BF9%u5E94%u989C%u8272%20red%uFF0C1%20%u5BF9%u5E94%20blue%uFF0C%u4F9D%u6B21%u7C7B%u63A8%u3002%u8FD9%u65F6%u5019%u5C31%u53EF%u4EE5%u7528%u5E8F%u5217%u6BD4%u4F8B%u5C3A%u3002%0A%60%60%60javascript%0A%0Avar%20ordinal%20%3D%20d3.scale.ordinal%28%29%0A%20%20%20%20%20%20%20%20.domain%28index%29%0A%20%20%20%20%20%20%20%20.range%28color%29%3B%0A%0Aordinal%280%29%3B%20//%u8FD4%u56DE%20red%0Aordinal%282%29%3B%20//%u8FD4%u56DE%20green%0Aordinal%284%29%3B%20//%u8FD4%u56DE%20black%0A%60%60%60%0A%0A%60%u989C%u8272%u6BD4%u4F8B%u5C3A%60%0A%u8981%u7ED9%u56FE%u8868%u8BBE%u5B9A%u989C%u8272%uFF0C%u6BCF%u6B21%u624B%u52A8%u8BBE%u7F6E%u975E%u5E38%u9EBB%u70E6%uFF0C%u8FD9%u65F6%u5019%u53EF%u4EE5%u4F7F%u7528%u989C%u8272%u6BD4%u4F8B%u5C3A%u3002%u5B83%u4EEC%u7684%u989C%u8272%u90FD%u7ED3%u679C%u7CBE%u5FC3%u7684%u8272%u5F69%u642D%u914D%uFF0C%u76F8%u5F53%u7F8E%u89C2%u3002%0A-%09category10%20%2010%u79CD%u989C%u8272%0A-%09category20%28%29%20%20%2020%u79CD%u989C%u8272%0A-%09category20b%28%29%20%2020%u79CD%u989C%u8272%0A-%09category20c%28%29%20%2020%u79CD%u989C%u8272%0A%60%60%60javascript%0A%3Chtml%3E%0A%0A%3Chead%3E%0A%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%3E%0A%20%20%20%20%3Ctitle%3E%u989C%u8272%u6BD4%u4F8B%u5C3A%3C/title%3E%0A%3C/head%3E%0A%0A%3Cbody%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//cdn.bootcss.com/d3/3.5.15/d3.js%22%3E%3C/script%3E%0A%0A%20%20%20%20%3Cscript%3E%0A%20%20%20%20%20%20%20%20var%20width%20%3D%201000%3B%0A%20%20%20%20%20%20%20%20var%20height%20%3D%20600%3B%0A%20%20%20%20%20%20%20%20var%20dataset%20%3D%20d3.range%2815%29%3B%20//%20%u8FD4%u56DE%5B0%2C%201%2C%202%2C%203%2C%204%2C%205%2C%206%2C%207%2C%208%2C%209%2C%2010%2C%2011%2C%2012%2C%2013%2C%2014%5D%0A%20%20%20%20%20%20%20%20var%20color%20%3D%20d3.scale.category10%28%29%3B%0A%0A%20%20%20%20%20%20%20%20var%20svg%20%3D%20d3.select%28%22body%22%29.append%28%22svg%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22width%22%2C%20width%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22height%22%2C%20height%29%3B%0A%0A%20%20%20%20%20%20%20%20var%20circle%20%3D%20svg.selectAll%28%22circle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.data%28dataset%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.enter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.append%28%22circle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cx%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%2020%20+%20i%20*%2060%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cy%22%2C%20100%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22r%22%2C%2015%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22fill%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20color%28i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%3C/script%3E%0A%0A%3C/body%3E%0A%0A%3C/html%3E%0A%60%60%60%0A%0A%60%u7ED9%u67F1%u5F62%u56FE%u6DFB%u52A0%u6BD4%u4F8B%u5C3A%60%0A%60%60%60javascript%0A%3Chtml%3E%0A%0A%3Chead%3E%0A%20%20%20%20%3Cmeta%20charset%3D%22utf-8%22%3E%0A%20%20%20%20%3Ctitle%3E%u6DFB%u52A0%u5750%u6807%u8F74%3C/title%3E%0A%3C/head%3E%0A%0A%3Cbody%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//cdn.bootcss.com/d3/3.5.15/d3.js%22%3E%3C/script%3E%0A%0A%20%20%20%20%3Cscript%3E%0A%20%20%20%20%20%20%20%20var%20width%20%3D%20300%3B%09//%u753B%u5E03%u7684%u5BBD%u5EA6%0A%20%20%20%20%20%20%20%20var%20height%20%3D%20300%3B%09//%u753B%u5E03%u7684%u9AD8%u5EA6%0A%0A%20%20%20%20%20%20%20%20var%20svg%20%3D%20d3.select%28%22body%22%29%09%09%09%09//%u9009%u62E9%u6587%u6863%u4E2D%u7684body%u5143%u7D20%0A%20%20%20%20%20%20%20%20%20%20%20%20.append%28%22svg%22%29%09%09%09%09//%u6DFB%u52A0%u4E00%u4E2Asvg%u5143%u7D20%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22width%22%2C%20width%29%09%09//%u8BBE%u5B9A%u5BBD%u5EA6%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22height%22%2C%20height%29%3B%09//%u8BBE%u5B9A%u9AD8%u5EA6%0A%0A%20%20%20%20%20%20%20%20var%20dataset%20%3D%20%5B250%2C%20210%2C%20170%2C%20130%2C%2090%5D%3B%20%20//%u6570%u636E%uFF08%u8868%u793A%u77E9%u5F62%u7684%u5BBD%u5EA6%uFF09%0A%20%20%20%20%20%20%20%20var%20linear%20%3D%20d3.scale.linear%28%29%0A%20%20%20%20%20%20%20%20.domain%28%5B0%2C%20d3.max%28dataset%29%5D%29%0A%20%20%20%20%20%20%20%20.range%28%5B0%2C%20100%5D%29%3B%0A%0A%20%20%20%20%20%20%20%20var%20rectHeight%20%3D%2025%3B%20%20%20//%u6BCF%u4E2A%u77E9%u5F62%u6240%u5360%u7684%u50CF%u7D20%u9AD8%u5EA6%28%u5305%u62EC%u7A7A%u767D%29%0A%0A%0A%20%20%20%20%20%20%20%20svg.selectAll%28%22rect%22%29%20//%20%u9009%u62E9svg%u5185%u6240%u6709%u7684%u77E9%u5F62%0A%20%20%20%20%20%20%20%20%20%20%20%20.data%28dataset%29%20//%20%u7ED1%u5B9A%u6570%u7EC4%0A%20%20%20%20%20%20%20%20%20%20%20%20.enter%28%29%20%20//%20%u6307%u5B9A%u9009%u62E9%u96C6%u7684enter%u90E8%u5206%0A%20%20%20%20%20%20%20%20%20%20%20%20.append%28%22rect%22%29%20//%20%u6DFB%u52A0%u8DB3%u591F%u6570%u91CF%u7684%u77E9%u5F62%u5143%u7D20%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22x%22%2C%2020%29%20//%20%u6DFB%u52A0%u4E86%u5143%u7D20%u4E4B%u540E%uFF0C%u5C31%u9700%u8981%u5206%u522B%u7ED9%u5404%u5143%u7D20%u7684%u5C5E%u6027%u8D4B%u503C%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22y%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20i%20*%20rectHeight%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22width%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20linear%28d%29%3B%20//%20//%u5728%u8FD9%u91CC%u7528%u6BD4%u4F8B%u5C3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22height%22%2C%20rectHeight%20-%202%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22fill%22%2C%20%22steelblue%22%29%3B%0A%20%20%20%20%3C/script%3E%0A%0A%3C/body%3E%0A%0A%3C/html%3E%0A%60%60%60%0A%0A%0A---%0A%23%23%23%23%u7B2C%u516D%u7AE0%20%u5750%u6807%u8F74%0A%21%5BAlt%20text%5D%28./1531401743135.png%29%0A%0A%u5750%u6807%u8F74%uFF0C%u662F%u53EF%u89C6%u5316%u56FE%u8868%u4E2D%u7ECF%u5E38%u51FA%u73B0%u7684%u4E00%u79CD%u56FE%u5F62%uFF0C%u7531%u4E00%u4E9B%60%u5217%u7EBF%u6BB5%60%u548C%60%u523B%u5EA6%60%u7EC4%u6210%u3002%u5750%u6807%u8F74%u5728%20SVG%20%u4E2D%u662F%u6CA1%u6709%u73B0%u6210%u7684%u56FE%u5F62%u5143%u7D20%u7684%uFF0C%u9700%u8981%u7528%u5176%u4ED6%u7684%u5143%u7D20%60%u7EC4%u5408%60%u6784%u6210%u3002%0A%u5728%20SVG%20%u753B%u5E03%u7684%u9884%u5B9A%u4E49%u5143%u7D20%u91CC%uFF0C%u6709%u516D%u79CD%u57FA%u672C%u56FE%u5F62%uFF1A%0A-%09%u77E9%u5F62%0A-%09%u5706%u5F62%0A-%09%u692D%u5706%0A-%09%u7EBF%u6BB5%0A-%09%u6298%u7EBF%0A-%09%u591A%u8FB9%u5F62%0A%0A%u53E6%u5916%uFF0C%u8FD8%u6709%u4E00%u79CD%u6BD4%u8F83%u7279%u6B8A%uFF0C%u4E5F%u662F%u529F%u80FD%u6700%u5F3A%u7684%u5143%u7D20%uFF1A%0A-%09%u8DEF%u5F84%0A%0A%u753B%u5E03%u4E2D%u7684%u6240%u6709%u56FE%u5F62%uFF0C%u90FD%u662F%u7531%u4EE5%u4E0A%u4E03%u79CD%u5143%u7D20%u7EC4%u6210%u3002%0A%60%60%60htmlbars%0A%3Cg%3E%0A%3C%21--%20%u7B2C%u4E00%u4E2A%u523B%u5EA6%20--%3E%0A%3Cg%3E%0A%3Cline%3E%3C/line%3E%20%20%20%3C%21--%20%u7B2C%u4E00%u4E2A%u523B%u5EA6%u7684%u76F4%u7EBF%20--%3E%0A%3Ctext%3E%3C/text%3E%20%20%20%3C%21--%20%u7B2C%u4E00%u4E2A%u523B%u5EA6%u7684%u6587%u5B57%20--%3E%0A%3C/g%3E%0A%3C%21--%20%u7B2C%u4E8C%u4E2A%u523B%u5EA6%20--%3E%0A%3Cg%3E%0A%3Cline%3E%3C/line%3E%20%20%20%3C%21--%20%u7B2C%u4E8C%u4E2A%u523B%u5EA6%u7684%u76F4%u7EBF%20--%3E%0A%3Ctext%3E%3C/text%3E%20%20%20%3C%21--%20%u7B2C%u4E8C%u4E2A%u523B%u5EA6%u7684%u6587%u5B57%20--%3E%0A%3C/g%3E%20%0A...%0A%3C%21--%20%u5750%u6807%u8F74%u7684%u8F74%u7EBF%20--%3E%0A%3Cpath%3E%3C/path%3E%0A%3C/g%3E%0A%60%60%60%0A%0A%u5206%u7EC4%u5143%u7D20%20%uFF0C%u662F%20SVG%20%u753B%u5E03%u4E2D%u7684%u5143%u7D20%uFF0C%u610F%u601D%u662F%20group%u3002%u6B64%u5143%u7D20%u662F%u5C06%u5176%u4ED6%u5143%u7D20%u8FDB%u884C%u7EC4%u5408%u7684%u5BB9%u5668%uFF0C%u5728%u8FD9%u91CC%u662F%u7528%u4E8E%u5C06%u5750%u6807%u8F74%u7684%u5176%u4ED6%u5143%u7D20%u5206%u7EC4%u5B58%u653E%u3002%0A%0A%u5982%u679C%u9700%u8981%u624B%u52A8%u6DFB%u52A0%u8FD9%u4E9B%u5143%u7D20%u5C31%u592A%u9EBB%u70E6%u4E86%uFF0C%u4E3A%u6B64%uFF0CD3%20%u63D0%u4F9B%u4E86%u4E00%u4E2A%u7EC4%u4EF6%uFF1A%60d3.svg.axis%28%29%60%u3002%0A%60%u5B9A%u4E49%u5750%u6807%u8F74%60%0A%u8981%u751F%u6210%60%u5750%u6807%u8F74%60%uFF0C%u9700%u8981%u7528%u5230%60%u6BD4%u4F8B%u5C3A%60%uFF0C%u5B83%u4EEC%u4E8C%u8005%u7ECF%u5E38%u662F%u4E00%u8D77%u4F7F%u7528%u7684%u3002%u5728%u4E0A%u4E00%u7AE0%u7684%u6570%u636E%u548C%u6BD4%u4F8B%u5C3A%u7684%u57FA%u7840%u4E0A%uFF0C%u6DFB%u52A0%u4E00%u4E2A%u5750%u6807%u8F74%u7684%u7EC4%u4EF6%u3002%0A%60%60%60javascript%0A//%u6570%u636E%0Avar%20dataset%20%3D%20%5B%202.5%20%2C%202.1%20%2C%201.7%20%2C%201.3%20%2C%200.9%20%5D%3B%0A//%u5B9A%u4E49%u6BD4%u4F8B%u5C3A%0Avar%20linear%20%3D%20d3.scale.linear%28%29%0A%20%20%20%20%20%20.domain%28%5B0%2C%20d3.max%28dataset%29%5D%29%0A%20%20%20%20%20%20.range%28%5B0%2C%20250%5D%29%3B%0A%0Avar%20axis%20%3D%20d3.svg.axis%28%29%0A%20%20%20%20%20.scale%28linear%29%20%20%20%20%20%20//%20%u6307%u5B9A%u6BD4%u4F8B%u5C3A%0A%20%20%20%20%20.orient%28%22bottom%22%29%20%20%20//%20%u6307%u5B9A%u523B%u5EA6%u7684%u65B9%u5411%0A%20%20%20%20%20.ticks%287%29%3B%20%20%20%20%20%20%20%20%20%20//%20%u6307%u5B9A%u523B%u5EA6%u7684%u6570%u91CF%0A%60%60%60%0A%0A%60%u5728%20SVG%20%u4E2D%u6DFB%u52A0%u5750%u6807%u8F74%60%0A%u5B9A%u4E49%u4E86%u5750%u6807%u8F74%u4E4B%u540E%uFF0C%u53EA%u9700%u8981%u5728%20SVG%20%u4E2D%u6DFB%u52A0%u4E00%u4E2A%u5206%u7EC4%u5143%u7D20%20%uFF0C%u518D%u5C06%u5750%u6807%u8F74%u7684%u5176%u4ED6%u5143%u7D20%u6DFB%u52A0%u5230%u8FD9%u4E2A%20%u91CC%u5373%u53EF%u3002%u4EE3%u7801%u5982%u4E0B%uFF1A%0A%60%60%60javascript%0Asvg.append%28%22g%22%29%0A%20%20%20.call%28axis%29%3B%0A%60%60%60%0A%u4E0A%u9762%u6709%u4E00%u4E2A%20call%28%29%20%u51FD%u6570%uFF0C%u5176%u53C2%u6570%u662F%u524D%u9762%u5B9A%u4E49%u7684%u5750%u6807%u8F74%20axis%u3002%0A%0A%0A%60%u8BBE%u5B9A%u5750%u6807%u8F74%u7684%u6837%u5F0F%u548C%u4F4D%u7F6E%60%0A%21%5BAlt%20text%5D%28./1531643246414.png%29%0A%u9ED8%u8BA4%u7684%u5750%u6807%u8F74%u6837%u5F0F%u4E0D%u592A%u7F8E%u89C2%2C%u9700%u8981%u5206%u522B%u5B9A%u4E49%u4E86%u7C7B%20axis%20%u4E0B%u7684%20path%u3001line%u3001text%20%u5143%u7D20%u7684%u6837%u5F0F%0A%60%60%60css%0A%3Cstyle%3E%0A.axis%20path%2C%0A.axis%20line%7B%0A%20%20%20%20fill%3A%20none%3B%0A%20%20%20%20stroke%3A%20black%3B%0A%20%20%20%20shape-rendering%3A%20crispEdges%3B%0A%7D%0A%0A.axis%20text%20%7B%0A%20%20%20%20font-family%3A%20sans-serif%3B%0A%20%20%20%20font-size%3A%2011px%3B%0A%7D%0A%3C/style%3E%0A%60%60%60%0A%u63A5%u4E0B%u6765%uFF0C%u53EA%u9700%u8981%u5C06%u5750%u6807%u8F74%u7684%u7C7B%u8BBE%u5B9A%u4E3A%20axis%20%u5373%u53EF%u3002%0A%60%60%60javascript%0Asvg.append%28%22g%22%29%0A%20%20.attr%28%22class%22%2C%22axis%22%29%0A%20%20.attr%28%22transform%22%2C%22translate%2820%2C130%29%22%29%0A%20%20.call%28axis%29%3B%0A%60%60%60%0A%u5750%u6807%u8F74%u7684%u4F4D%u7F6E%uFF0C%u53EF%u4EE5%u901A%u8FC7%20transform%20%u5C5E%u6027%u6765%u8BBE%u5B9A%u3002%0A%0A%0A%0A%0A%23%23%23%23%20%u7B2C%u4E03%u7AE0%20%u5B8C%u6574%u7684%u67F1%u5F62%u56FE%0A%u4E00%u4E2A%u5B8C%u6574%u7684%u67F1%u5F62%u56FE%u5305%u542B%u4E09%u90E8%u5206%uFF1A%60%u77E9%u5F62%60%u3001%60%u6587%u5B57%60%u3001%60%u5750%u6807%u8F74%60%u3002%u672C%u7AE0%u5C06%u5BF9%u524D%u51E0%u7AE0%u7684%u5185%u5BB9%u8FDB%u884C%u7EFC%u5408%u7684%u8FD0%u7528%2C%u5BF9%u5185%u5BB9%u8FDB%u884C%u7EFC%u5408%u7684%u8FD0%u7528%uFF0C%u5236%u4F5C%u4E00%u4E2A%u5B9E%u7528%u7684%u67F1%u5F62%u56FE%uFF0C%u5185%u5BB9%u5305%u62EC%uFF1A%u9009%u62E9%u96C6%u3001%u6570%u636E%u7ED1%u5B9A%u3001%u6BD4%u4F8B%u5C3A%u3001%u5750%u6807%u8F74%u7B49%u5185%u5BB9%u3002%0A%21%5BAlt%20text%5D%28./1531405124395.png%29%0A%60%u6DFB%u52A0%20SVG%20%u753B%u5E03%60%0A%60%60%60javascript%0A//%u753B%u5E03%u5927%u5C0F%0Avar%20width%20%3D%20400%3B%0Avar%20height%20%3D%20400%3B%0A//%u5728%20body%20%u91CC%u6DFB%u52A0%u4E00%u4E2A%20SVG%20%u753B%u5E03%20%20%20%0Avar%20svg%20%3D%20d3.select%28%22body%22%29%0A%20%20%20%20.append%28%22svg%22%29%0A%20%20%20%20.attr%28%22width%22%2C%20width%29%0A%20%20%20%20.attr%28%22height%22%2C%20height%29%3B%0A%0A//%u753B%u5E03%u5468%u8FB9%u7684%u7A7A%u767D%0A//%20%u5B9A%u4E49%u4E86%u4E00%u4E2A%20padding%uFF0C%u662F%u4E3A%u4E86%u7ED9%20SVG%20%u7684%u5468%u8FB9%u7559%u4E00%u4E2A%u7A7A%u767D%uFF0C%u6700%u597D%u4E0D%u8981%u5C06%u56FE%u5F62%u7ED8%u5236%u5230%u8FB9%u754C%u4E0A%0A%20var%20padding%20%3D%20%7Bleft%3A30%2C%20right%3A30%2C%20top%3A20%2C%20bottom%3A20%7D%3B%0A%60%60%60%0A%60%u5B9A%u4E49%u6570%u636E%u548C%u6BD4%u4F8B%u5C3A%60%0A%60%60%60javascript%0A//%u5B9A%u4E49%u4E00%u4E2A%u6570%u7EC4%0Avar%20dataset%20%3D%20%5B10%2C%2020%2C%2030%2C%2040%2C%2033%2C%2024%2C%2012%2C%205%5D%3B%0A%0A//%20x%u8F74%u7684%u6BD4%u4F8B%u5C3A%0A//%20x%u8F74%u4F7F%u7528%u5E8F%u6570%u6BD4%u4F8B%u5C3A%0Avar%20xScale%20%3D%20d3.scale.ordinal%28%29%0A%20%20%20%20.domain%28d3.range%28dataset.length%29%29%0A%20%20%20%20.rangeRoundBands%28%5B0%2C%20width%20-%20padding.left%20-%20padding.right%5D%29%3B%20//%20%20%u6307%u5B9A%u8F93%u51FA%u8303%u56F4%u4E3A%u8FDE%u7EED%u533A%u95F4%uFF0C%u533A%u95F4%u6BB5%u7684%u8D77%u70B9%u5747%u4E3A%u6574%u6570%0A%0A//%20y%u8F74%u7684%u6BD4%u4F8B%u5C3A%0A//%20y%u8F74%u4F7F%u7528%u7EBF%u6027%u6BD4%u4F8B%u5C3A%0Avar%20yScale%20%3D%20d3.scale.linear%28%29%0A%20%20%20%20.domain%28%5B0%2Cd3.max%28dataset%29%5D%29%0A%20%20%20%20.range%28%5Bheight%20-%20padding.top%20-%20padding.bottom%2C%200%5D%29%3B%20//%20%u53CD%u8FC7%u6765%0A%60%60%60%0A%60%u5B9A%u4E49%u5750%u6807%u8F74%60%0A%60%60%60javascript%0A//%u5B9A%u4E49x%u8F74%0Avar%20xAxis%20%3D%20d3.svg.axis%28%29%0A%20%20%20%20.scale%28xScale%29%0A%20%20%20%20.orient%28%22bottom%22%29%3B%20//%20x%20%u8F74%u523B%u5EA6%u7684%u65B9%u5411%u5411%u4E0B%20%0A%0A//%u5B9A%u4E49y%u8F74%0Avar%20yAxis%20%3D%20d3.svg.axis%28%29%0A%20%20%20%20.scale%28yScale%29%0A%20%20%20%20.orient%28%22left%22%29%3B%20//%20y%20%u8F74%u7684%u5411%u5DE6%0A%60%60%60%0A%0A%60%u6DFB%u52A0%u77E9%u5F62%u548C%u6587%u5B57%u5143%u7D20%60%0A%60%60%60javascript%0A//%u77E9%u5F62%u4E4B%u95F4%u7684%u7A7A%u767D%0A%20%20%20%20%20%20%20%20var%20rectPadding%20%3D%204%3B%0A%0A%20%20%20%20%20%20%20%20//%u6DFB%u52A0%u77E9%u5F62%u5143%u7D20%0A%20%20%20%20%20%20%20%20var%20rects%20%3D%20svg.selectAll%28%22.MyRect%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.data%28dataset%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.enter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.append%28%22rect%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22class%22%2C%20%22MyRect%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22transform%22%2C%20%22translate%28%22%20+%20padding.left%20+%20%22%2C%22%20+%20padding.top%20+%20%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22x%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20xScale%28i%29%20+%20rectPadding%20/%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22y%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20yScale%28d%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22width%22%2C%20xScale.rangeBand%28%29%20-%20rectPadding%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22height%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20height%20-%20padding.top%20-%20padding.bottom%20-%20yScale%28d%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%0A%20%20%20%20%20%20%20%20//%u6DFB%u52A0%u6587%u5B57%u5143%u7D20%0A%20%20%20%20%20%20%20%20var%20texts%20%3D%20svg.selectAll%28%22.MyText%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.data%28dataset%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.enter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.append%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22class%22%2C%20%22MyText%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22transform%22%2C%20%22translate%28%22%20+%20padding.left%20+%20%22%2C%22%20+%20padding.top%20+%20%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22x%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20xScale%28i%29%20+%20rectPadding%20/%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22y%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20yScale%28d%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22dx%22%2C%20function%20%28%29%20%7B%20//%20%u662F%u6587%u672C%u76F8%u5BF9%u57FA%u70B9x%u65B9%u5411%u53F3%u504F%u79FB%u7684%u8DDD%u79BB%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%28xScale.rangeBand%28%29%20-%20rectPadding%29%20/%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22dy%22%2C%20function%20%28d%29%20%7B%20%20//%20%u662F%u6587%u672C%u76F8%u5BF9%u57FA%u70B9y%u65B9%u5411%u4E0B%u504F%u79FB%u7684%u8DDD%u79BB%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%2020%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.text%28function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20d%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%60%60%60%0A%0A%60%u6DFB%u52A0%u5750%u6807%u8F74%u7684%u5143%u7D20%60%0A%60%60%60javascript%0A%20%20%20%20%20%20%20%20//%u6DFB%u52A0x%u8F74%0A%20%20%20%20%20%20%20%20svg.append%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22class%22%2C%20%22axis%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22transform%22%2C%20%22translate%28%22%20+%20padding.left%20+%20%22%2C%22%20+%20%28height%20-%20padding.bottom%29%20+%20%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.call%28xAxis%29%3B%0A%0A%20%20%20%20%20%20%20%20//%u6DFB%u52A0y%u8F74%0A%20%20%20%20%20%20%20%20svg.append%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22class%22%2C%20%22axis%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22transform%22%2C%20%22translate%28%22%20+%20padding.left%20+%20%22%2C%22%20+%20padding.top%20+%20%22%29%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.call%28yAxis%29%3B%0A%60%60%60%0A%0A---%0A%23%23%23%23%20%u7B2C%u516B%u7AE0%20%u52A8%u753B%u6548%u679C%0A%60%u4EC0%u4E48%u662F%u52A8%u6001%u6548%u679C%60%0A%3E%u524D%u9762%u5236%u4F5C%u7684%u56FE%u8868%u662F%u4E00%u8E74%u800C%u5C31%u5730%u51FA%u73B0%uFF0C%u7136%u540E%u7ED8%u5236%u5B8C%u6210%u540E%u4E0D%u518D%u53D1%u751F%u53D8%u5316%u7684%uFF0C%u8FD9%u662F%60%u9759%u6001%60%u7684%u56FE%u8868%u3002%0A%60%u52A8%u6001%60%u7684%u56FE%u8868%uFF0C%u662F%u6307%u56FE%u8868%u5728%u67D0%u4E00%u65F6%u95F4%u6BB5%u4F1A%u53D1%u751F%u67D0%u79CD%u53D8%u5316%uFF0C%u53EF%u80FD%u662F%60%u5F62%u72B6%60%u3001%60%u989C%u8272%60%u3001%60%u4F4D%u7F6E%60%u7B49%u3002%0A%u4F8B%u5982%uFF0C%u6709%u4E00%u4E2A%u5706%uFF0C%u5706%u5FC3%u4E3A%20%28100%2C%20100%29%u3002%u73B0%u5728%u6211%u4EEC%u5E0C%u671B%u5706%u7684%20x%20%u5750%u6807%u4ECE%20100%20%u79FB%u5230%20300%uFF0C%u5E76%u4E14%u79FB%u52A8%u8FC7%u7A0B%u5728%202%20%u79D2%u7684%u65F6%u95F4%u5185%u53D1%u751F%u3002%20%20%0A%u8FD9%u79CD%u65F6%u5019%u5C31%u9700%u8981%u7528%u5230%u52A8%u6001%u6548%u679C%uFF0C%u5728%20D3%20%u91CC%u6211%u4EEC%u79F0%u4E4B%u4E3A%60%u8FC7%u6E21%uFF08transition%uFF09%60%u3002%0A%0A%60%u5B9E%u73B0%u52A8%u6001%u7684%u65B9%u6CD5%60%0AD3%20%u63D0%u4F9B%u4E86%204%20%u4E2A%u65B9%u6CD5%u7528%u4E8E%u5B9E%u73B0%u56FE%u5F62%u7684%u8FC7%u6E21%uFF1A%u4ECE**%u72B6%u6001%20A**%20%u53D8%u4E3A**%u72B6%u6001%20B**%u3002%0A-%09transition%28%29%0A%20%u542F%u52A8%u8FC7%u6E21%u6548%u679C%u3002%0A%20%u5176%u524D%u540E%u662F%u56FE%u5F62%u53D8%u5316%u524D%u540E%u7684%u72B6%u6001%uFF08%u5F62%u72B6%u3001%u4F4D%u7F6E%u3001%u989C%u8272%u7B49%u7B49%uFF09%uFF0C%u4F8B%u5982%uFF1A%0A%20%0A%20%60%60%60javascript%0A%20%20.attr%28%22fill%22%2C%22red%22%29%20%20%20%20%20%20%20%20%20//%u521D%u59CB%u989C%u8272%u4E3A%u7EA2%u8272%0A.transition%28%29%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%u542F%u52A8%u8FC7%u6E21%0A.attr%28%22fill%22%2C%22steelblue%22%29%20%20%20//%u7EC8%u6B62%u989C%u8272%u4E3A%u94C1%u84DD%u8272%0A%20%60%60%60%0A%20D3%20%u4F1A%u81EA%u52A8%u5BF9%u4E24%u79CD%u989C%u8272%uFF08%u7EA2%u8272%u548C%u94C1%u84DD%u8272%uFF09%u4E4B%u95F4%u7684%u989C%u8272%u503C%uFF08RGB%u503C%uFF09%u8FDB%u884C%u63D2%u503C%u8BA1%u7B97%uFF0C%u5F97%u5230%u8FC7%u6E21%u7528%u7684%u989C%u8272%u503C%u3002%0A%20%0A-%20duration%28%29%0A%u6307%u5B9A%u8FC7%u6E21%u7684%u6301%u7EED%u65F6%u95F4%uFF0C%u5355%u4F4D%u4E3A%u6BEB%u79D2%u3002%0A%u5982%20duration%282000%29%20%uFF0C%u6307%u6301%u7EED%202000%20%u6BEB%u79D2%uFF0C%u5373%202%20%u79D2%u3002%0A-%20ease%28%29%0A%u6307%u5B9A%u8FC7%u6E21%u7684%u65B9%u5F0F%uFF0C%u5E38%u7528%u7684%u6709%0A%09-%20%20linear%uFF1A%u666E%u901A%u7684%u7EBF%u6027%u53D8%u5316%0A%09-%20%20circle%uFF1A%u6162%u6162%u5730%u5230%u8FBE%u53D8%u6362%u7684%u6700%u7EC8%u72B6%u6001%0A%20%20%20%20-%20%20elastic%uFF1A%u5E26%u6709%u5F39%u8DF3%u7684%u5230%u8FBE%u6700%u7EC8%u72B6%u6001%0A%20%20%20%20-%20%20bounce%uFF1A%u5728%u6700%u7EC8%u72B6%u6001%u5904%u5F39%u8DF3%u51E0%u6B21%0A%20%20%0A%20%20%u8C03%u7528%u65F6%uFF0C%u683C%u5F0F%u5F62%u5982%uFF1A%20ease%28%u201Cbounce%u201D%29%0A%20%20%0A-%20delay%28%29%0A%u6307%u5B9A%u5EF6%u8FDF%u7684%u65F6%u95F4%uFF0C%u8868%u793A%u4E00%u5B9A%u65F6%u95F4%u540E%u624D%u5F00%u59CB%u8F6C%u53D8%uFF0C%u5355%u4F4D%u540C%u6837%u4E3A%u6BEB%u79D2%u3002%u6B64%u51FD%u6570%u53EF%u4EE5%u5BF9%60%u6574%u4F53%60%u6307%u5B9A%u5EF6%u8FDF%uFF0C%u4E5F%u53EF%u4EE5%u5BF9%60%u4E2A%u522B%60%u6307%u5B9A%u5EF6%u8FDF%u3002%0A%0A**%u5BF9%u6574%u4F53%u6307%u5B9A%u65F6**%0A%60%60%60javascript%0A.transition%28%29%0A.duration%281000%29%0A.delay%28500%29%0A%60%60%60%0A%u5982%u6B64%uFF0C%u56FE%u5F62%u6574%u4F53%u5728%60%u5EF6%u8FDF%60%20500%20%u6BEB%u79D2%u540E%u53D1%u751F%u53D8%u5316%uFF0C%60%u53D8%u5316%60%u7684%u65F6%u957F%u4E3A%201000%20%u6BEB%u79D2%u3002%u56E0%u6B64%uFF0C%u8FC7%u6E21%u7684%60%u603B%u65F6%u957F%60%u4E3A1500%u6BEB%u79D2%u3002%0A%0A**%u5BF9%u4E2A%u522B%u56FE%u5F62%u8FDB%u884C%u6307%u5B9A%u65F6**%0A%60%60%60javascript%0A.transition%28%29%0A.duration%281000%29%0A.delay%28funtion%28d%2Ci%29%7B%0A%20%20%20%20return%20200*i%3B%0A%7D%29%0A%60%60%60%0A%u5982%u6B64%uFF0C%u5047%u8BBE%u6709%2010%20%u4E2A%u5143%u7D20%uFF0C%u90A3%u4E48%u7B2C%201%20%u4E2A%u5143%u7D20%u5EF6%u8FDF%200%20%u6BEB%u79D2%uFF08%u56E0%u4E3A%20i%20%3D%200%uFF09%uFF0C%u7B2C%202%20%u4E2A%u5143%u7D20%u5EF6%u8FDF%20200%20%u6BEB%u79D2%uFF0C%u7B2C%203%20%u4E2A%u5EF6%u8FDF%20400%20%u6BEB%u79D2%uFF0C%u4F9D%u6B21%u7C7B%u63A8%u2026.%u6574%u4E2A%u8FC7%u6E21%u7684%u957F%u5EA6%u4E3A%20200%20*%209%20+%201000%20%3D%202800%20%u6BEB%u79D2%u3002%0A%0A%0A---%0A%60%u5B9E%u73B0%u7B80%u5355%u7684%u52A8%u6001%u6548%u679C%60%0A%u5728%20SVG%20%u753B%u5E03%u91CC%u6DFB%u52A0%u4E09%u4E2A%u5706%uFF0C%u5706%u51FA%u73B0%u4E4B%u540E%uFF0C%u7ACB%u5373%u542F%u52A8%u8FC7%u6E21%u6548%u679C%u3002%0A%u7B2C%u4E00%u4E2A%u5706%uFF0C%u8981%u6C42%u79FB%u52A8%20x%20%u5750%u6807%u3002%0A%u7B2C%u4E8C%u4E2A%u5706%uFF0C%u8981%u6C42%u65E2%u79FB%u52A8%20x%20%u5750%u6807%uFF0C%u53C8%u6539%u53D8%u989C%u8272%u3002%0A%u7B2C%u4E09%u4E2A%u5706%uFF0C%u8981%u6C42%u65E2%u79FB%u52A8%20x%20%u5750%u6807%uFF0C%u53C8%u6539%u53D8%u989C%u8272%uFF0C%u8FD8%u6539%u53D8%u534A%u5F84%0A%60%60%60javascript%0Avar%20circle1%20%3D%20svg.append%28%22circle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cx%22%2C%20100%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cy%22%2C%20100%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22r%22%2C%2045%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.style%28%22fill%22%2C%20%22green%22%29%3B%0A%0A%20%20%20%20%20%20%20%20//%u57281%u79D2%uFF081000%u6BEB%u79D2%uFF09%u5185%u5C06%u5706%u5FC3%u5750%u6807%u7531100%u53D8%u4E3A300%0A%20%20%20%20%20%20%20%20circle1.transition%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.duration%281000%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cx%22%2C%20300%29%3B%0A%0A%20%20%20%20%20%20%20%20var%20circle2%20%3D%20svg.append%28%22circle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cx%22%2C%20100%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cy%22%2C%20200%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22r%22%2C%2045%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.style%28%22fill%22%2C%20%22green%22%29%3B%0A%0A%20%20%20%20%20%20%20%20//%u57281.5%u79D2%uFF081500%u6BEB%u79D2%uFF09%u5185%u5C06%u5706%u5FC3%u5750%u6807%u7531100%u53D8%u4E3A300%uFF0C%0A%20%20%20%20%20%20%20%20//%u5C06%u989C%u8272%u4ECE%u7EFF%u8272%u53D8%u4E3A%u7EA2%u8272%0A%20%20%20%20%20%20%20%20circle2.transition%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.duration%281500%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cx%22%2C%20300%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.style%28%22fill%22%2C%20%22red%22%29%3B%0A%0A%20%20%20%20%20%20%20%20var%20circle3%20%3D%20svg.append%28%22circle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cx%22%2C%20100%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cy%22%2C%20300%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22r%22%2C%2045%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.style%28%22fill%22%2C%20%22green%22%29%3B%0A%0A%20%20%20%20%20%20%20%20//%u57282%u79D2%uFF082000%u6BEB%u79D2%uFF09%u5185%u5C06%u5706%u5FC3%u5750%u6807%u7531100%u53D8%u4E3A300%0A%20%20%20%20%20%20%20%20//%u5C06%u989C%u8272%u4ECE%u7EFF%u8272%u53D8%u4E3A%u7EA2%u8272%0A%20%20%20%20%20%20%20%20//%u5C06%u534A%u5F84%u4ECE45%u53D8%u621025%0A%20%20%20%20%20%20%20%20//%u8FC7%u6E21%u65B9%u5F0F%u91C7%u7528bounce%uFF08%u5728%u7EC8%u70B9%u5904%u5F39%u8DF3%u51E0%u6B21%uFF09%0A%20%20%20%20%20%20%20%20circle3.transition%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.duration%282000%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.ease%28%22bounce%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cx%22%2C%20300%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.style%28%22fill%22%2C%20%22red%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22r%22%2C%2025%29%3B%0A%60%60%60%0A%0A%60%u7ED9%u67F1%u5F62%u56FE%u52A0%u4E0A%u52A8%u6001%u6548%u679C%60%0A%u5728%u6DFB%u52A0%60%u6587%u5B57%u5143%u7D20%60%u548C%60%u77E9%u5F62%u5143%u7D20%60%u7684%u65F6%u5019%uFF0C%60%u542F%u52A8%u8FC7%u6E21%u6548%u679C%60%uFF0C%u8BA9%u5404%u67F1%u5F62%u548C%u6587%u5B57%u7F13%u6162%u5347%u81F3%u76EE%u6807%u9AD8%u5EA6%uFF0C%u5E76%u4E14%u5728%u76EE%u6807%u5904%u8DF3%u52A8%u51E0%u6B21%u3002%u4E24%u8005%u53D1%u751F%u53D8%u5316%u7684%u90FD%u662F%20y%20%u5750%u6807%u3002%u5199%u6E05%u695A%60%u8D77%u59CB%u72B6%u6001%60%u548C%60%u7EC8%u6B62%u72B6%u6001%60%u3002%0A%u4EE5%u4E0B%u662F%u4E3A%u6587%u5B57%u6DFB%u52A0%u8FC7%u6E21%u6548%u679C%u7684%u4EE3%u7801%uFF1A%0A%60%60%60javascript%0A.attr%28%22y%22%2Cfunction%28d%29%7B%0A%20%20%20%20var%20min%20%3D%20yScale.domain%28%29%5B0%5D%3B%0A%20%20%20%20return%20yScale%28min%29%3B%0A%7D%29%0A.transition%28%29%0A.delay%28function%28d%2Ci%29%7B%0A%20%20%20%20return%20i%20*%20200%3B%0A%7D%29%0A.duration%282000%29%0A.ease%28%22bounce%22%29%0A.attr%28%22y%22%2Cfunction%28d%29%7B%0A%20%20%20%20return%20yScale%28d%29%3B%0A%7D%29%3B%0A%60%60%60%0A%0A%0A%0A%0A---%0A%23%23%23%23%20%u7B2C%u4E5D%u7AE0%20%u7406%u89E3%20Update%u3001Enter%u3001Exit%0A%u524D%u51E0%u7AE0%u91CC%uFF0C%u53CD%u590D%u51FA%u73B0%u4E86%u5F62%u5982%u4EE5%u4E0B%u7684%u4EE3%u7801%u3002%u5F53%u65F6%u5E76%u6CA1%u6709%u6DF1%u7A76%u8FD9%u6BB5%u4EE3%u7801%u662F%u4EC0%u4E48%u610F%u601D%uFF0C%u672C%u7AE0%u5C06%u5BF9%u6B64%u8FDB%u884C%u8BB2%u89E3%u3002%0A%60%60%60javascript%0Asvg.selectAll%28%22rect%22%29%20%20%20//%u9009%u62E9svg%u5185%u6240%u6709%u7684%u77E9%u5F62%0A%20%20%20%20.data%28dataset%29%20%20%20%20%20%20//%u7ED1%u5B9A%u6570%u7EC4%0A%20%20%20%20.enter%28%29%20%20%20%20%20%20%20%20%20%20%20%20//%u6307%u5B9A%u9009%u62E9%u96C6%u7684enter%u90E8%u5206%0A%20%20%20%20.append%28%22rect%22%29%20%20%20%20%20//%u6DFB%u52A0%u8DB3%u591F%u6570%u91CF%u7684%u77E9%u5F62%u5143%u7D20%0A%60%60%60%0A%60%u4EC0%u4E48%u662F%20Update%u3001Enter%u3001Exit%60%0A%21%5BAlt%20text%5D%28./1531411630906.png%29%0A%0A%u4EE5%u4E0B%u9762%u8FD9%u4E2A%u4F8B%u5B50%u4E3A%u4F8B%uFF0C%u5982%u679C%u6570%u7EC4%u4E3A%20%5B3%2C%206%2C%209%2C%2012%2C%2015%5D%uFF0C%u5C06%u6B64%u6570%u7EC4%u7ED1%u5B9A%u5230%u4E09%u4E2A%20p%20%u5143%u7D20%u7684%u9009%u62E9%u96C6%u4E0A%u3002%0A%21%5BAlt%20text%5D%28./1531412615083.png%29%0A-%09update%20%u90E8%u5206%u7684%u5904%u7406%u529E%u6CD5%u4E00%u822C%u662F%uFF1A%u66F4%u65B0%u5C5E%u6027%u503C%u3002%0A-%09enter%20%u90E8%u5206%u7684%u5904%u7406%u529E%u6CD5%u4E00%u822C%u662F%uFF1A%u6DFB%u52A0%u5143%u7D20%u540E%uFF0C%u8D4B%u4E88%u5C5E%u6027%u503C%u3002%0A-%09exit%20%u90E8%u5206%u7684%u5904%u7406%u529E%u6CD5%u4E00%u822C%u662F%uFF1A%u5220%u9664%u5143%u7D20%uFF08remove%uFF09%u3002%0A%0A%60Update%20%u548C%20Enter%20%u7684%u4F7F%u7528%60%0A%60%60%60javascript%0Avar%20dataset%20%3D%20%5B%203%20%2C%206%20%2C%209%20%2C%2012%20%2C%2015%20%5D%3B%0A//%u9009%u62E9body%u4E2D%u7684p%u5143%u7D20%0Avar%20p%20%3D%20d3.select%28%22body%22%29.selectAll%28%22p%22%29%3B%0A//%u83B7%u53D6update%u90E8%u5206%0Avar%20update%20%3D%20p.data%28dataset%29%3B%0A//%u83B7%u53D6enter%u90E8%u5206%0Avar%20enter%20%3D%20update.enter%28%29%3B%0A//update%u90E8%u5206%u7684%u5904%u7406%uFF1A%u66F4%u65B0%u5C5E%u6027%u503C%0Aupdate.text%28function%28d%29%7B%0A%20%20%20%20return%20%22update%20%22%20+%20d%3B%0A%7D%29%3B%0A//enter%u90E8%u5206%u7684%u5904%u7406%uFF1A%u6DFB%u52A0%u5143%u7D20%u540E%u8D4B%u4E88%u5C5E%u6027%u503C%0Aenter.append%28%22p%22%29%0A%20%20%20%20.text%28function%28d%29%7B%0A%20%20%20%20%20%20%20%20return%20%22enter%20%22%20+%20d%3B%0A%20%20%20%20%7D%29%3B%0A%60%60%60%0A%u7ED3%u679C%u5982%u4E0B%u56FE%uFF0Cupdate%20%u90E8%u5206%u548C%20enter%20%u90E8%u5206%u88AB%u7ED1%u5B9A%u7684%u6570%u636E%u5F88%u6E05%u6670%u5730%u8868%u793A%u4E86%u51FA%u6765%u3002%0A%21%5BAlt%20text%5D%28./1531650001513.png%29%0A%0A%60Update%20%u548C%20Exit%20%u7684%u4F7F%u7528%60%0A%u5F53%u5BF9%u5E94%u7684%u5143%u7D20%u8FC7%u591A%u65F6%20%uFF08%20%u7ED1%u5B9A%u6570%u636E%u6570%u91CF%20%3C%20%u5BF9%u5E94%u5143%u7D20%20%uFF09%uFF0C%u9700%u8981%u5220%u6389%u591A%u4F59%u7684%u5143%u7D20%u3002%0A%60%60%60javascript%0Avar%20dataset%20%3D%20%5B%203%20%5D%3B%0A%0A//%u9009%u62E9body%u4E2D%u7684p%u5143%u7D20%0Avar%20p%20%3D%20d3.select%28%22body%22%29.selectAll%28%22p%22%29%3B%0A%0A//%u83B7%u53D6update%u90E8%u5206%0Avar%20update%20%3D%20p.data%28dataset%29%3B%0A%0A//%u83B7%u53D6exit%u90E8%u5206%0Avar%20exit%20%3D%20update.exit%28%29%3B%0A%0A//update%u90E8%u5206%u7684%u5904%u7406%uFF1A%u66F4%u65B0%u5C5E%u6027%u503C%0Aupdate.text%28function%28d%29%7B%0A%20%20%20%20return%20%22update%20%22%20+%20d%3B%0A%7D%29%3B%0A%0A//exit%u90E8%u5206%u7684%u5904%u7406%uFF1A%u4FEE%u6539p%u5143%u7D20%u7684%u5C5E%u6027%0Aexit.text%28function%28d%29%7B%0A%20%20%20%20%20%20%20%20return%20%22exit%22%3B%0A%20%20%20%20%7D%29%3B%0A%20%20%20%20%0A//exit%u90E8%u5206%u7684%u5904%u7406%u901A%u5E38%u662F%u5220%u9664%u5143%u7D20%0A//%20exit.remove%28%29%3B%0A%60%60%60%0A%21%5BAlt%20text%5D%28./1531650184080.png%29%0A%0A%0A%0A%0A%0A%23%23%23%23%u7B2C%u5341%u7AE0%20%u4EA4%u4E92%u64CD%u4F5C%0A%21%5BAlt%20text%5D%28./1531448236642.png%29%0A%u5BF9%u53EF%u89C6%u5316%u56FE%u8868%u6765%u8BF4%uFF0C%u4EA4%u4E92%u80FD%u4F7F%u56FE%u8868%u66F4%u52A0%u751F%u52A8%uFF0C%u80FD%u8868%u73B0%u66F4%u591A%u5185%u5BB9%u3002%u4F8B%u5982%uFF0C%60%u62D6%u52A8%60%u56FE%u8868%u4E2D%u67D0%u4E9B%u56FE%u5F62%u3001%u9F20%u6807%u6ED1%u5230%u56FE%u5F62%u4E0A%u51FA%u73B0%60%u63D0%u793A%u6846%60%u3001%u7528%u89E6%u5C4F%60%u653E%u5927%60%u6216%60%u7F29%u5C0F%60%u56FE%u5F62%u7B49%u7B49%u3002%0A%u7528%u6237%u7528%u4E8E%u4EA4%u4E92%u7684%u5DE5%u5177%u4E00%u822C%u6709%u4E09%u79CD%uFF1A%60%u9F20%u6807%60%u3001%60%u952E%u76D8%60%u3001%60%u89E6%u5C4F%60%u3002%0A%60%u5982%u4F55%u6DFB%u52A0%u4EA4%u4E92%60%0A%u5BF9%u67D0%u4E00%u5143%u7D20%u6DFB%u52A0%u4EA4%u4E92%u64CD%u4F5C%u5341%u5206%u7B80%u5355%uFF0C%u4EE3%u7801%u5982%u4E0B%uFF1A%0A%60%60%60javascript%0Avar%20circle%20%3D%20svg.append%28%22circle%22%29%3B%0Acircle.on%28%22click%22%2C%20function%28%29%7B%0A%20%20%20%20//%u5728%u8FD9%u91CC%u6DFB%u52A0%u4EA4%u4E92%u5185%u5BB9%0A%7D%29%3B%0A%60%60%60%0A%3Eon%28%29%20%u7684%u7B2C%u4E00%u4E2A%u53C2%u6570%u662F%60%u76D1%u542C%u7684%u4E8B%u4EF6%60%uFF0C%u7B2C%u4E8C%u4E2A%u53C2%u6570%u662F%u76D1%u542C%u5230%u4E8B%u4EF6%u540E%60%u54CD%u5E94%60%u7684%u5185%u5BB9%uFF0C%u7B2C%u4E8C%u4E2A%u53C2%u6570%u662F%u4E00%u4E2A%u51FD%u6570%u3002%0A%u9F20%u6807%u5E38%u7528%u7684%u4E8B%u4EF6%u6709%3A%0A-%09click%uFF1A%u9F20%u6807%u5355%u51FB%u67D0%u5143%u7D20%u65F6%uFF0C%u76F8%u5F53%u4E8E%20mousedown%20%u548C%20mouseup%20%u7EC4%u5408%u5728%u4E00%u8D77%u3002%0A-%09mouseover%uFF1A%u5149%u6807%u653E%u5728%u67D0%u5143%u7D20%u4E0A%u3002%0A-%09mouseout%uFF1A%u5149%u6807%u4ECE%u67D0%u5143%u7D20%u4E0A%u79FB%u51FA%u6765%u65F6%u3002%0A-%09mousemove%uFF1A%u9F20%u6807%u88AB%u79FB%u52A8%u7684%u65F6%u5019%u3002%0A-%09mousedown%uFF1A%u9F20%u6807%u6309%u94AE%u88AB%u6309%u4E0B%u3002%0A-%09mouseup%uFF1A%u9F20%u6807%u6309%u94AE%u88AB%u677E%u5F00%u3002%0A-%09dblclick%uFF1A%u9F20%u6807%u53CC%u51FB%u3002%0A%0A%u952E%u76D8%u5E38%u7528%u7684%u4E8B%u4EF6%u6709%u4E09%u4E2A%uFF1A%0A-%09keydown%uFF1A%u5F53%u7528%u6237%u6309%u4E0B%u4EFB%u610F%u952E%u65F6%u89E6%u53D1%uFF0C%u6309%u4F4F%u4E0D%u653E%u4F1A%u91CD%u590D%u89E6%u53D1%u6B64%u4E8B%u4EF6%u3002%u8BE5%u4E8B%u4EF6%u4E0D%u4F1A%u533A%u5206%u5B57%u6BCD%u7684%u5927%u5C0F%u5199%uFF0C%u4F8B%u5982%u201CA%u201D%u548C%u201Ca%u201D%u88AB%u89C6%u4E3A%u4E00%u81F4%u3002%0A-%09keypress%uFF1A%u5F53%u7528%u6237%u6309%u4E0B%u5B57%u7B26%u952E%uFF08%u5927%u5C0F%u5199%u5B57%u6BCD%u3001%u6570%u5B57%u3001%u52A0%u53F7%u3001%u7B49%u53F7%u3001%u56DE%u8F66%u7B49%uFF09%u65F6%u89E6%u53D1%uFF0C%u6309%u4F4F%u4E0D%u653E%u4F1A%u91CD%u590D%u89E6%u53D1%u6B64%u4E8B%u4EF6%u3002%u8BE5%u4E8B%u4EF6%u533A%u5206%u5B57%u6BCD%u7684%u5927%u5C0F%u5199%u3002%0A-%09keyup%uFF1A%u5F53%u7528%u6237%u91CA%u653E%u952E%u65F6%u89E6%u53D1%uFF0C%u4E0D%u533A%u5206%u5B57%u6BCD%u7684%u5927%u5C0F%u5199%u3002%0A%0A%20%u89E6%u5C4F%u5E38%u7528%u7684%u4E8B%u4EF6%u6709%u4E09%u4E2A%uFF1A%0A-%09touchstart%uFF1A%u5F53%u89E6%u6478%u70B9%u88AB%u653E%u5728%u89E6%u6478%u5C4F%u4E0A%u65F6%u3002%0A-%09touchmove%uFF1A%u5F53%u89E6%u6478%u70B9%u5728%u89E6%u6478%u5C4F%u4E0A%u79FB%u52A8%u65F6%u3002%0A-%09touchend%uFF1A%u5F53%u89E6%u6478%u70B9%u4ECE%u89E6%u6478%u5C4F%u4E0A%u62FF%u5F00%u65F6%u3002%20%0A%0A%0A%60%u5E26%u6709%u4EA4%u4E92%u7684%u67F1%u5F62%u56FE%60%0A%u5C06%u67F1%u5F62%u56FE%u7684%u90E8%u5206%u4EE3%u7801%u4FEE%u6539%u6210%u5982%u4E0B%u4EE3%u7801%uFF1A%0A%u586B%u5145%u989C%u8272%u4E0D%u8981%u5199%u5728CSS%u91CC%2C%u56E0%u4E3ACSS%u5C5E%u6027%u7684%u7EA7%u522B%u6BD4attr%28%29%u7684%u8981%u9AD8%u3002%0A%u5F53%u67D0%u4E2A%u4E8B%u4EF6%u88AB%u76D1%u542C%u5230%u65F6%uFF0CD3%20%u4F1A%u628A%u5F53%u524D%u7684%u4E8B%u4EF6%u5B58%u5230%20d3.event%20%u5BF9%u8C61%uFF0C%u91CC%u9762%u4FDD%u5B58%u4E86%u5F53%u524D%u4E8B%u4EF6%u7684%u5404%u79CD%u53C2%u6570%u3002%0A%60%60%60javascript%0A//%u6DFB%u52A0%u77E9%u5F62%u5143%u7D20%0A%09%09var%20rects%20%3D%20svg.selectAll%28%22.MyRect%22%29%0A%09%09%09.data%28dataset%29%0A%09%09%09.enter%28%29%0A%09%09%09.append%28%22rect%22%29%0A%09%09%09//%20.attr%28%22class%22%2C%20%22MyRect%22%29%20//%20%0A%09%09%09.attr%28%22transform%22%2C%20%22translate%28%22%20+%20padding.left%20+%20%22%2C%22%20+%20padding.top%20+%20%22%29%22%29%0A%09%09%09.attr%28%22x%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%09%09%09%09return%20xScale%28i%29%20+%20rectPadding%20/%202%3B%0A%09%09%09%7D%29%0A%09%09%09.attr%28%22y%22%2C%20function%20%28d%29%20%7B%0A%09%09%09%09return%20yScale%28d%29%3B%0A%09%09%09%7D%29%0A%09%09%09.attr%28%22width%22%2C%20xScale.rangeBand%28%29%20-%20rectPadding%29%0A%09%09%09.attr%28%22height%22%2C%20function%20%28d%29%20%7B%0A%09%09%09%09return%20height%20-%20padding.top%20-%20padding.bottom%20-%20yScale%28d%29%3B%0A%09%09%09%7D%29%0A%09%09%09.attr%28%22fill%22%2C%20%22steelblue%22%29%09%09//%20%u586B%u5145%u989C%u8272%u4E0D%u8981%u5199%u5728CSS%u91CC%0A%09%09%09.on%28%22mouseover%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%09%09%09%09d3.select%28this%29%20//%20d3.select%28this%29%uFF0C%u8868%u793A%u9009%u62E9%u5F53%u524D%u7684%u5143%u7D20%0A%09%09%09%09%09.attr%28%22fill%22%2C%20%22yellow%22%29%3B%0A%09%09%09%09//%20console.log%28d3.event.screenX%29%3B%0A%09%09%09%7D%29%0A%09%09%09.on%28%22mouseout%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%09%09%09%09d3.select%28this%29%0A%09%09%09%09%09.transition%28%29%0A%09%09%09%09%09.duration%28500%29%0A%09%09%09%09%09.attr%28%22fill%22%2C%20%22steelblue%22%29%3B%0A%09%09%09%7D%29%3B%0A%60%60%60%0A%0A---%0A%23%23%23%23%u7B2C%u5341%u4E00%u7AE0%20%u5E03%u5C40%0A%21%5BAlt%20text%5D%28./1531450018437.png%29%0A%60%u5E03%u5C40%u662F%u4EC0%u4E48%60%0A%u5E03%u5C40%uFF0C%u82F1%u6587%u662F%20Layout%u3002%u5E03%u5C40%u662F%20D3%20%u4E2D%u4E00%u4E2A%u5341%u5206%u91CD%u8981%u7684%u6982%u5FF5%u3002D3%20%u4E0E%u5176%u5B83%u5F88%u591A%u53EF%u89C6%u5316%u5DE5%u5177%u4E0D%u540C%uFF0C%u76F8%u5BF9%u6765%u8BF4%u8F83%u5E95%u5C42%uFF0C%u5BF9%u521D%u5B66%u8005%u6765%u8BF4%u4E0D%u592A%u65B9%u4FBF%uFF0C%u4F46%u662F%u4E00%u65E6%u638C%u63E1%u4E86%uFF0C%u5C31%u6BD4%u5176%u4ED6%u5DE5%u5177%u66F4%u52A0%u5F97%u5FC3%u5E94%u624B%u3002%0A%21%5BAlt%20text%5D%28./1531450222651.png%29%0A%60D3%u7ED8%u56FE%60%uFF1A%0A%u5C06%u6570%u636E%u53D8%u4E3A%u56FE%u8868%uFF0C%u5206%u4E3A%u4E24%u6B65%uFF1A%u8BA1%u7B97%u548C%u7ED8%u5236%u3002%0A%u8BA1%u7B97%u662F%u6307%u7B97%u51FA%u8282%u70B9%u7684%u4F4D%u7F6E%u3001%u7EBF%u6BB5%u7684%u7AEF%u70B9%u3001%u5F27%u7EBF%u7684%u89D2%u5EA6%u7B49%u3002%u7ED8%u5236%u662F%u5C06%u8BA1%u7B97%u6240%u5F97%u7684%u8282%u70B9%u3001%u7EBF%u6BB5%u7B49%u5143%u7D20%u7ED8%u5236%u5728%u7F51%u9875%u4E0A%u3002%0A%60%u5927%u90E8%u5206%u7ED8%u56FE%u5DE5%u5177%60%3A%0A%u5C06%u8BA1%u7B97%u548C%u7ED8%u5236%u6574%u5408%u5230%u4E00%u8D77%u3002%0A%0A%60D3%u7684%u4F18%u52BF%60%0A%u6781%u5927%u63D0%u9AD8%u4E86%u8BBE%u8BA1%u7684%u81EA%u7531%u5EA6%0A%0A%60%u5982%u4F55%u7406%u89E3%u5E03%u5C40%60%0A%u5E03%u5C40%u53EF%u4EE5%u7406%u89E3%u4E3A%60%u6570%u636E%u8F6C%u6362%60%0A%u6BD4%u5982%uFF0C%u6709%u6570%u636E%5B10%2C20%2C30%2C40%5D%2C%u8981%u5C06%u5176%u753B%u6210%u997C%u72B6%u56FE%uFF0C%u9700%u8981%u5C06%u6570%u636E%u8F6C%u6362%u6210%u6247%u5F62%u7684%u8D77%u59CB%u89D2%u5EA6%u548C%u7EC8%u6B62%u89D2%u5EA6%u3002%0A-%0910%20-%3E%20%u8D77%u59CB%u89D2%u5EA60%uFF0C%u7EC8%u6B62%u89D2%u5EA636%0A-%0920%20-%3E%20%u8D77%u59CB%u89D2%u5EA636%20%2C%u7EC8%u6B62%u89D2%u5EA6108%0A%0A%60%u5E03%u5C40%u6709%u54EA%u4E9B%60%0AD3%20%u603B%u5171%u63D0%u4F9B%u4E86%2012%20%u4E2A%u5E03%u5C40%uFF1A%u997C%u72B6%u56FE%uFF08Pie%uFF09%u3001%u529B%u5BFC%u5411%u56FE%uFF08Force%uFF09%u3001%u5F26%u56FE%uFF08Chord%uFF09%u3001%u6811%u72B6%u56FE%uFF08Tree%uFF09%u3001%u96C6%u7FA4%u56FE%uFF08Cluster%uFF09%u3001%u6346%u56FE%uFF08Bundle%uFF09%u3001%u6253%u5305%u56FE%uFF08Pack%uFF09%u3001%u76F4%u65B9%u56FE%uFF08Histogram%uFF09%u3001%u5206%u533A%u56FE%uFF08Partition%uFF09%u3001%u5806%u6808%u56FE%uFF08Stack%uFF09%u3001%u77E9%u9635%u6811%u56FE%uFF08Treemap%uFF09%u3001%u5C42%u7EA7%u56FE%uFF08Hierarchy%uFF09%u3002%0A%60%u997C%u72B6%u56FE%uFF08Pie%uFF09%60%0A%21%5BAlt%20text%5D%28./1531457914291.png%29%0A%60%u529B%u5BFC%u5411%u56FE%uFF08Force%uFF09%60%0A%21%5BAlt%20text%5D%28./1531457929809.png%29%0A%60%u5F26%u56FE%uFF08Chord%uFF09%60%0A%21%5BAlt%20text%5D%28./1531457937589.png%29%0A%60%u6811%u72B6%u56FE%uFF08Tree%uFF09%60%0A%21%5BAlt%20text%5D%28./1531457948664.png%29%0A%60%u96C6%u7FA4%u56FE%uFF08Cluster%uFF09%60%0A%21%5BAlt%20text%5D%28./1531457959655.png%29%0A%60%u6346%u56FE%uFF08Bundle%uFF09%60%0A%21%5BAlt%20text%5D%28./1531457966003.png%29%0A%60%u6253%u5305%u56FE%uFF08Pack%uFF09%60%0A%21%5BAlt%20text%5D%28./1531457972735.png%29%0A%60%u76F4%u65B9%u56FE%uFF08Histogram%uFF09%60%0A%21%5BAlt%20text%5D%28./1531458021184.png%29%0A%60%u5206%u533A%u56FE%uFF08Partition%uFF09%60%0A%21%5BAlt%20text%5D%28./1531458036521.png%29%0A%60%u5806%u6808%u56FE%uFF08Stack%uFF09%60%0A%21%5BAlt%20text%5D%28./1531458041862.png%29%0A%60%u77E9%u9635%u6811%u56FE%uFF08Treemap%uFF09%60%0A%21%5BAlt%20text%5D%28./1531458047207.png%29%0A%0A%0A%23%23%23%23%u7B2C%u5341%u4E8C%u7AE0%20%u997C%u72B6%u56FE%u7684%u5236%u4F5C%0A%21%5BAlt%20text%5D%28./1531458492502.png%29%0A**%u5C55%u793A%u79BB%u6563%u6570%u636E%u70B9%u767E%u5206%u5360%u6BD4%u6216%u8005%u5927%u5C0F%u6BD4%u8F83**%0A%60%u6570%u636E%60%0A%60%60%60javascript%0Avar%20dataset%20%3D%20%5B%2030%20%2C%2010%20%2C%2043%20%2C%2055%20%2C%2013%20%5D%3B%0A%60%60%60%0A%60%u5E03%u5C40%28%u6570%u636E%u8F6C%u6362%29%60%0A%60%60%60javascript%0A%20%20%20var%20pie%20%3D%20d3.layout.pie%28%29%3B%0A%20%20%20var%20piedata%20%3D%20pie%28dataset%29%3B%0A%60%60%60%0A%0A%21%5BAlt%20text%5D%28./1531459281643.png%29%0A%u5343%u4E07%u8BB0%u4F4F%uFF1A%u5E03%u5C40%u4E0D%u662F%u76F4%u63A5%u7ED8%u56FE%uFF0C%u800C%u662F%u4E3A%u4E86%u5F97%u5230%u7ED8%u56FE%u6240%u9700%u7684%60%u6570%u636E%60%u3002%0A%0A%60%u7ED8%u5236%u56FE%u5F62%60%0ASVG%20%u6709%u4E00%u4E2A%u5143%u7D20%uFF0C%u53EB%u505A%60%u8DEF%u5F84%20path%60%uFF0C%u662F%20SVG%20%u4E2D%u529F%u80FD%u6700%u5F3A%u7684%u5143%u7D20%uFF0C%u5B83%u53EF%u4EE5%u8868%u793A%u5176%u5B83%60%u4EFB%u610F%u7684%u56FE%u5F62%60%u3002%u7ED8%u5236%u997C%u72B6%u56FE%u9700%u8981%u4F7F%u7528%60%u5F27%u751F%u6210%u5668%60%u3002%u5B83%u53EF%u4EE5%u751F%u6210%60%u5F27%u7684%u8DEF%u5F84%60%u3002%0A%u5F27%u751F%u6210%u5668%u8FD4%u56DE%u7684%u7ED3%u679C%u8D4B%u503C%u7ED9%20arc%u3002%u6B64%u65F6%uFF0Carc%20%u53EF%u4EE5%u5F53%u505A%u4E00%u4E2A%u51FD%u6570%u4F7F%u7528%uFF0C%u628A%20piedata%20%u4F5C%u4E3A%u53C2%u6570%u4F20%u5165%uFF0C%u5373%u53EF%u5F97%u5230%u8DEF%u5F84%u503C%u3002%0A%60%60%60javascript%0Avar%20outerRadius%20%3D%20150%3B%20//%20%u5916%u534A%u5F84%0Avar%20innerRadius%20%3D%200%3B%20//%20%u5185%u534A%u5F84%uFF0C%u4E3A0%u5219%u4E2D%u95F4%u6CA1%u6709%u7A7A%u767D%0Avar%20arc%20%3D%20d3.svg.arc%28%29%20%20//%20%u5F27%u751F%u6210%u5668%0A%20%20%20%20.innerRadius%28innerRadius%29%20%20%20//%u8BBE%u7F6E%u5185%u534A%u5F84%0A%20%20%20%20.outerRadius%28outerRadius%29%3B%20%20//%u8BBE%u7F6E%u5916%u534A%u5F84%0A%60%60%60%0A%u5728%20svg%20%u91CC%u6DFB%u52A0%u8DB3%u591F%u6570%u91CF%u7684%u5206%u7EC4%u5143%u7D20%uFF08g%uFF09%uFF0C%u6BCF%u4E00%u4E2A%u5206%u7EC4%u7528%u4E8E%u5B58%u653E%u4E00%u6BB5%u5F27%u7684%u76F8%u5173%u5143%u7D20%u3002%0A%60%60%60javascript%0Avar%20arcs%20%3D%20svg.selectAll%28%22g%22%29%0A%20%20%20%20.data%28piedata%29%0A%20%20%20%20.enter%28%29%0A%20%20%20%20.append%28%22g%22%29%0A%20%20%20%20.attr%28%22transform%22%2C%22translate%28%22+%20%28width/2%29%20+%22%2C%22+%20%28width/2%29%20+%22%29%22%29%3B%0A%60%60%60%0A%u63A5%u4E0B%u6765%u5BF9%u6BCF%u4E2A%20g%20%u5143%u7D20%uFF0C%u6DFB%u52A0%20path%20%u3002%0A%0A%60%60%60javascript%0Aarcs.append%28%22path%22%29%0A%20%20%20%20.attr%28%22fill%22%2Cfunction%28d%2Ci%29%7B%0A%20%20%20%20%20%20%20%20return%20color%28i%29%3B%20//%20%u989C%u8272%u6BD4%u4F8B%u5C3A%0A%20%20%20%20%7D%29%0A%20%20%20//%20.attr%28%22d%22%2C%20function%20%28d%29%20%7B%0A%20%20%20//%20%20%20%20%20return%20arc%28d%29%3B%20//%20%u4F7F%u7528%u5F27%u751F%u6210%u5668%u83B7%u53D6%u8DEF%u5F84%0A%20%20%20//%20%7D%29%3B%0A%20%20%20%20.attr%28%22d%22%2C%20arc%29%3B%20//s%20arc%u672C%u8EAB%u5C31%u662F%u4E00%u4E2A%u51FD%u6570%2C%u53EF%u4EE5%u7B80%u5199%u4E3Aarc%0A%0A%60%60%60%0A%0A%u7136%u540E%u5728%u6BCF%u4E00%u4E2A%u5F27%u7EBF%u4E2D%u5FC3%u6DFB%u52A0%u6587%u672C%u3002%0Aarc.centroid%28d%29%20%u80FD%u7B97%u51FA%u5F27%u7EBF%u7684%u4E2D%u5FC3%u5750%u6807%uFF0C%u8FD4%u56DE%u4E00%u4E2A%5Bx%2Cy%5D%u6570%u7EC4%u3002%0Atext-anchor%u6587%u672C%u76F8%u5BF9%u57FA%u70B9%uFF08x%uFF0Cy%uFF09%u7684%u4F4D%u7F6E%20%0A-%09start%20%u6587%u5B57%u5728%u57FA%u70B9%u7684%u53F3%u4E0A%u65B9%0A-%09middle%20%u6587%u5B57%u5728%u57FA%u70B9%u7684%u6B63%u4E0A%u65B9%0A-%09end%20%u6587%u5B57%u5728%u57FA%u70B9%u7684%u5DE6%u4E0A%u65B9%0A%60%60%60javascript%0Aarcs.append%28%22text%22%29%0A%20%20%20%20.attr%28%22transform%22%2Cfunction%28d%29%7B%0A%20%20%20%20%20%20%20%20return%20%22translate%28%22%20+%20arc.centroid%28d%29%20+%20%22%29%22%3B%20//%20%u7B97%u51FA%u5F27%u7EBF%u7684%u4E2D%u5FC3%20%0A%20%20%20%20%7D%29%0A%20%20%20%20.attr%28%22text-anchor%22%2C%22middle%22%29%0A%20%20%20%20.text%28function%28d%29%7B%0A%20%20%20%20%20%20%20%20return%20d.data%3B%20//%20%20d.data%uFF0C%u800C%u4E0D%u662Fd%uFF0C%u56E0%u4E3A%u88AB%u7ED1%u5B9A%u7684%u6570%u636E%u662F%u5BF9%u8C61%0A%20%20%20%20%7D%29%3B%0A%60%60%60%0A%0A%0A%0A%23%23%23%23%u7B2C%u5341%u4E09%u7AE0%20%u529B%u5BFC%u5411%u56FE%0A%u529B%u5BFC%u5411%u56FE%uFF08Force-Directed%20Graph%uFF09%uFF0C%u662F%u7ED8%u56FE%u7684%u4E00%u79CD%u7B97%u6CD5%u3002%u5728%u4E8C%u7EF4%u6216%u4E09%u7EF4%u7A7A%u95F4%u91CC%u914D%u7F6E%60%u8282%u70B9%60%uFF0C%u8282%u70B9%u4E4B%u95F4%u7528%u7EBF%u8FDE%u63A5%uFF0C%u79F0%u4E3A%60%u8FDE%u7EBF%60%u3002%u5404%u8FDE%u7EBF%u7684%u957F%u5EA6%u51E0%u4E4E%u76F8%u7B49%uFF0C%u4E14%u5C3D%u53EF%u80FD%u4E0D%u76F8%u4EA4%u3002%u8282%u70B9%u548C%u8FDE%u7EBF%u90FD%u88AB%u65BD%u52A0%u4E86%u529B%u7684%u4F5C%u7528%uFF0C%u529B%u662F%u6839%u636E%u8282%u70B9%u548C%u8FDE%u7EBF%u7684%u76F8%u5BF9%u4F4D%u7F6E%u8BA1%u7B97%u7684%u3002%u6839%u636E%u529B%u7684%u4F5C%u7528%uFF0C%u6765%u8BA1%u7B97%u8282%u70B9%u548C%u8FDE%u7EBF%u7684%u8FD0%u52A8%u8F68%u8FF9%uFF0C%u5E76%u4E0D%u65AD%u964D%u4F4E%u5B83%u4EEC%u7684%u80FD%u91CF%uFF0C%u6700%u7EC8%u8FBE%u5230%u4E00%u79CD%u80FD%u91CF%u5F88%u4F4E%u7684%u5B89%u5B9A%u72B6%u6001%u3002%0A**%u9002%u5408%u7F51%u7EDC%u578B%u3001%u793E%u4EA4%u578B%u56FE%u6570%u636E%u7684%u53EF%u89C6%u5316%u5C55%u793A%u3002**%0A%21%5BAlt%20text%5D%28./1531461998072.png%29%0A%60%u6570%u636E%60%0A%u8282%u70B9%uFF08nodes%uFF09%u548C%u8FDE%u7EBF%uFF08edges%uFF09%u7684%u6570%u7EC4%0A%60%60%60javascript%0Avar%20nodes%20%3D%20%5B%20%7B%20name%3A%20%22%u6842%u6797%22%20%7D%2C%20%7B%20name%3A%20%22%u5E7F%u5DDE%22%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%20name%3A%20%22%u53A6%u95E8%22%20%7D%2C%20%7B%20name%3A%20%22%u676D%u5DDE%22%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%20name%3A%20%22%u4E0A%u6D77%22%20%7D%2C%20%7B%20name%3A%20%22%u9752%u5C9B%22%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%20name%3A%20%22%u5929%u6D25%22%20%7D%20%5D%3B%0A%0A%20var%20edges%20%3D%20%5B%20%7B%20source%20%3A%200%20%2C%20target%3A%201%20%7D%20%2C%20%7B%20source%20%3A%200%20%2C%20target%3A%202%20%7D%20%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%20source%20%3A%200%20%2C%20target%3A%203%20%7D%20%2C%20%7B%20source%20%3A%201%20%2C%20target%3A%204%20%7D%20%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%20source%20%3A%201%20%2C%20target%3A%205%20%7D%20%2C%20%7B%20source%20%3A%201%20%2C%20target%3A%206%20%7D%20%5D%3B%0A%60%60%60%0A%60%u5E03%u5C40%28%u6570%u636E%u8F6C%u6362%29%60%0A%u5B9A%u4E49%u4E00%u4E2A%u529B%u5BFC%u5411%u56FE%u7684%u5E03%u5C40%0A%60%60%60javascript%0Avar%20force%20%3D%20d3.layout.force%28%29%0A%20%20%20%20%20%20.nodes%28nodes%29%20//%u6307%u5B9A%u8282%u70B9%u6570%u7EC4%0A%20%20%20%20%20%20.links%28edges%29%20//%u6307%u5B9A%u8FDE%u7EBF%u6570%u7EC4%0A%20%20%20%20%20%20.size%28%5Bwidth%2Cheight%5D%29%20//%u6307%u5B9A%u4F5C%u7528%u57DF%u8303%u56F4%0A%20%20%20%20%20%20.linkDistance%28150%29%20//%u6307%u5B9A%u8FDE%u7EBF%u957F%u5EA6%0A%20%20%20%20%20%20.charge%28%5B-400%5D%29%3B%20//%u76F8%u4E92%u4E4B%u95F4%u7684%u4F5C%u7528%u529B%0A%60%60%60%0A%0A%u4F7F%u529B%u5B66%u4F5C%u7528%u751F%u6548%uFF1A%0A%60%60%60javascript%0Aforce.start%28%29%3B%09//%20%u5F00%u59CB%u8BA1%u7B97%u5E03%u5C40%0A%60%60%60%0A%u6570%u636E%u53D8%u6362%u524D%u540E%0A%u8282%u70B9%0A%21%5BAlt%20text%5D%28./1531462348121.png%29%0A%u8F6C%u6362%u540E%uFF0C%u8282%u70B9%u5BF9%u8C61%u91CC%u591A%u4E86%u4E00%u4E9B%u53D8%u91CF%u3002%u5176%u610F%u4E49%u5982%u4E0B%uFF1A%0A-%09index%uFF1A%u8282%u70B9%u7684%u7D22%u5F15%u53F7%0A-%09px%2C%20py%uFF1A%u8282%u70B9%u4E0A%u4E00%u4E2A%u65F6%u523B%u7684%u5750%u6807%0A-%09x%2C%20y%uFF1A%u8282%u70B9%u7684%u5F53%u524D%u5750%u6807%0A-%09weight%uFF1A%u8282%u70B9%u7684%u6743%u91CD%0A%0A%u8FDE%u7EBF%u7684%u53D8%u5316%0A%21%5BAlt%20text%5D%28./1531462399893.png%29%0A%u53EF%u4EE5%u770B%u5230%uFF0C%u8FDE%u7EBF%u7684%u4E24%u4E2A%u8282%u70B9%u5E8F%u53F7%uFF0C%u5206%u522B%u53D8%u6210%u4E86%u5BF9%u5E94%u7684%u8282%u70B9%u5BF9%u8C61%u3002%0A%0A%60%u7ED8%u5236%60%0A%u5206%u522B%u7ED8%u5236%u4E09%u79CD%u56FE%u5F62%u5143%u7D20%uFF1A%0A-%09line%uFF0C%u7EBF%u6BB5%uFF0C%u8868%u793A%u8FDE%u7EBF%u3002%0A-%09circle%uFF0C%u5706%uFF0C%u8868%u793A%u8282%u70B9%u3002%0A-%09text%uFF0C%u6587%u5B57%uFF0C%u63CF%u8FF0%u8282%u70B9%u3002%0A%0A%60%60%60javascript%0A//%u6DFB%u52A0%u8FDE%u7EBF%20%0A%20var%20svg_edges%20%3D%20svg.selectAll%28%22line%22%29%0A%20%20%20%20%20.data%28edges%29%0A%20%20%20%20%20.enter%28%29%0A%20%20%20%20%20.append%28%22line%22%29%0A%20%20%20%20%20.style%28%22stroke%22%2C%22%23ccc%22%29%0A%20%20%20%20%20.style%28%22stroke-width%22%2C1%29%3B%0A%0A%20var%20color%20%3D%20d3.scale.category20%28%29%3B%0A%0A%20//%u6DFB%u52A0%u8282%u70B9%20%0A%20var%20svg_nodes%20%3D%20svg.selectAll%28%22circle%22%29%0A%20%20%20%20%20.data%28nodes%29%0A%20%20%20%20%20.enter%28%29%0A%20%20%20%20%20.append%28%22circle%22%29%0A%20%20%20%20%20.attr%28%22r%22%2C20%29%0A%20%20%20%20%20.style%28%22fill%22%2Cfunction%28d%2Ci%29%7B%0A%20%20%20%20%20%20%20%20%20return%20color%28i%29%3B%0A%20%20%20%20%20%7D%29%0A%20%20%20%20%20.call%28force.drag%29%3B%20%20//%u4F7F%u5F97%u8282%u70B9%u80FD%u591F%u62D6%u52A8%0A%0A%20//%u6DFB%u52A0%u63CF%u8FF0%u8282%u70B9%u7684%u6587%u5B57%0A%20var%20svg_texts%20%3D%20svg.selectAll%28%22text%22%29%0A%20%20%20%20%20.data%28nodes%29%0A%20%20%20%20%20.enter%28%29%0A%20%20%20%20%20.append%28%22text%22%29%0A%20%20%20%20%20.style%28%22fill%22%2C%20%22black%22%29%0A%20%20%20%20%20.attr%28%22dx%22%2C%2020%29%0A%20%20%20%20%20.attr%28%22dy%22%2C%208%29%0A%20%20%20%20%20.text%28function%28d%29%7B%0A%20%20%20%20%20%20%20%20return%20d.name%3B%0A%20%20%20%20%20%7D%29%3B%0A%60%60%60%0A%u7531%u4E8E%u529B%u5BFC%u5411%u56FE%u662F%u4E0D%u65AD%u8FD0%u52A8%u7684%uFF0C%u6BCF%u4E00%u65F6%u523B%u90FD%u5728%u53D1%u751F%u66F4%u65B0%uFF0C%u56E0%u6B64%uFF0C%u5FC5%u987B%u4E0D%u65AD%u66F4%u65B0%u8282%u70B9%u548C%u8FDE%u7EBF%u7684%u4F4D%u7F6E%u3002%u8FD8%u9700%u8981%u8BBE%u7F6E%u4E00%u4E2A%u76D1%u542C%u5668%uFF0C%u4E3Atick%u4E8B%u4EF6%u8BBE%u7F6E%u76D1%u542C%u5668%u5373%u53EF%u3002%0A%60%60%60javascript%0Aforce.on%28%22tick%22%2C%20function%20%28%29%20%7B%09//%20%u5BF9%u8FD0%u52A8%u4E2D%u7684%u6BCF%u4E00%u6B65%u8FDB%u884C%u76D1%u542C%0A%20%20%20%20%20%20%20%20%20%20%20%20//%20%u66F4%u65B0%u8FDE%u7EBF%u5750%u6807%0A%20%20%20%20%20%20%20%20%20%20%20%20svg_edges.attr%28%22x1%22%2C%20function%20%28d%29%20%7B%20return%20d.source.x%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22y1%22%2C%20function%20%28d%29%20%7B%20return%20d.source.y%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22x2%22%2C%20function%20%28d%29%20%7B%20return%20d.target.x%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22y2%22%2C%20function%20%28d%29%20%7B%20return%20d.target.y%3B%20%7D%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20//%u66F4%u65B0%u8282%u70B9%u5750%u6807%0A%20%20%20%20%20%20%20%20%20%20%20%20svg_nodes.attr%28%22cx%22%2C%20function%20%28d%29%20%7B%20return%20d.x%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22cy%22%2C%20function%20%28d%29%20%7B%20return%20d.y%3B%20%7D%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20//%u66F4%u65B0%u6587%u5B57%u5750%u6807%0A%20%20%20%20%20%20%20%20%20%20%20%20svg_texts.attr%28%22x%22%2C%20function%20%28d%29%20%7B%20return%20d.x%3B%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22y%22%2C%20function%20%28d%29%20%7B%20return%20d.y%3B%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%60%60%60%0A%0A%0A%23%23%23%23%u7B2C%u5341%u56DB%u7AE0%20%u6811%u72B6%u56FE%0A%u6811%u72B6%u56FE%uFF0C**%u53EF%u8868%u793A%u8282%u70B9%u4E4B%u95F4%u7684%u5305%u542B%u4E0E%u88AB%u5305%u542B%u5173%u7CFB%u3002**%0A%21%5BAlt%20text%5D%28./1531667378247.png%29%0A%0A%60%u6570%u636E%60%0A%u521D%u59CB%u6570%u636E%u5148%u5199%u5728%u4E00%u4E2A%20%60JSON%60%20%u6587%u4EF6%u4E2D%uFF0C%u518D%u7528%20D3%20%u6765%u8BFB%u53D6%u3002%0A%5BJSON%20%u6559%u7A0B%5D%28http%3A//www.runoob.com/json/json-tutorial.html%29%0A%60%60%60json%0A%7B%0A%22name%22%3A%22%u4E2D%u56FD%22%2C%0A%22children%22%3A%0A%5B%0A%20%20%20%20%7B%20%0A%20%20%20%20%20%20%22name%22%3A%22%u6D59%u6C5F%22%20%2C%20%0A%20%20%20%20%20%20%22children%22%3A%0A%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u676D%u5DDE%22%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u5B81%u6CE2%22%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u6E29%u5DDE%22%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u7ECD%u5174%22%20%7D%0A%20%20%20%20%20%20%5D%20%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%7B%20%0A%20%20%20%20%20%20%20%20%22name%22%3A%22%u5E7F%u897F%22%20%2C%20%0A%20%20%20%20%20%20%20%20%22children%22%3A%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22name%22%3A%22%u6842%u6797%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22children%22%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u79C0%u5CF0%u533A%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u53E0%u5F69%u533A%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u8C61%u5C71%u533A%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u4E03%u661F%u533A%22%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u5357%u5B81%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u67F3%u5DDE%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u9632%u57CE%u6E2F%22%7D%0A%20%20%20%20%20%20%20%20%5D%20%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%7B%20%0A%20%20%20%20%20%20%20%20%22name%22%3A%22%u9ED1%u9F99%u6C5F%22%2C%0A%20%20%20%20%20%20%20%20%22children%22%3A%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u54C8%u5C14%u6EE8%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u9F50%u9F50%u54C8%u5C14%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u7261%u4E39%u6C5F%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u5927%u5E86%22%7D%0A%20%20%20%20%20%20%20%20%5D%20%0A%20%20%20%20%7D%2C%0A%0A%20%20%20%20%7B%20%0A%20%20%20%20%20%20%20%20%22name%22%3A%22%u65B0%u7586%22%20%2C%20%0A%20%20%20%20%20%20%20%20%22children%22%3A%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u4E4C%u9C81%u6728%u9F50%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u514B%u62C9%u739B%u4F9D%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u5410%u9C81%u756A%22%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%22name%22%3A%22%u54C8%u5BC6%22%7D%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%7D%0A%5D%0A%7D%0A%60%60%60%0A%60%u5E03%u5C40%uFF08%u6570%u636E%u8F6C%u6362%uFF09%60%0A%u5B9A%u4E49%u4E00%u4E2A%u6811%u56FE%u5E03%u5C40%uFF1A%0Aseparation%28%29%u7684%u53C2%u6570%u662Ffunction%28a%2Cb%29%uFF0Ca%2Cb%u8868%u793A%u4E24%u4E2A%u76F8%u90BB%u8282%u70B9%20%20%u5982%u679Ca%u8282%u70B9%u548Cb%u8282%u70B9%u7684%u7236%u8282%u70B9%u662F%u76F8%u540C%u7684%uFF0Ca%u548Cb%u7684%u95F4%u9694%u662F1%uFF0C%u5426%u5219%u662F2%u3002%0A%60%60%60javascript%0Avar%20tree%20%3D%20d3.layout.tree%28%29%0A%20%20.size%28%5Bwidth%2C%20height-200%5D%29%20//%20size%28%29%uFF1A%u8BBE%u5B9A%u5C3A%u5BF8%uFF0C%u5373%u8F6C%u6362%u540E%u7684%u5404%u8282%u70B9%u7684%u5750%u6807%u5728%u54EA%u4E00%u4E2A%u8303%u56F4%u5185%u3002%0A%20%20.separation%28function%28a%2C%20b%29%20%7B%20return%20%28a.parent%20%3D%3D%20b.parent%20%3F%201%20%3A%202%29%3B%20%7D%29%3B%0A%60%60%60%0A%u8BFB%u53D6%u6570%u636E%0A%60%60%60javascript%0A//%20%u8BFB%u53D6%u7684%u6587%u4EF6%u5185%u5BB9%u5728root%u4E2D%0Ad3.json%28%22city_tree.json%22%2C%20function%28error%2C%20root%29%20%7B%0A%20%20var%20nodes%20%3D%20tree.nodes%28root%29%3B%20%20//%20%u8BA1%u7B97%u5F97%u5230%u8282%u70B9%u6570%u7EC4%uFF0C%u4FDD%u5B58%u5728%u53D8%u91CFnodes%u4E2D%0A%20%20var%20links%20%3D%20tree.links%28nodes%29%3B%20//%20%u5F97%u5230%u8FDE%u7EBF%u6570%u7EC4%uFF0C%u4FDD%u5B58%u5728links%u4E2D%0A%20%20console.log%28nodes%29%3B%0A%20%20console.log%28links%29%3B%0A%0A%7D%0A%60%60%60%0A%u8F93%u51FA%u8282%u70B9%u7684%u7ED3%u679C%uFF1A%0Anodes%20%u4E2D%u6709%u5404%u4E2A%u8282%u70B9%u7684%u5B50%u8282%u70B9%uFF08children%uFF09%u3001%u6DF1%u5EA6%uFF08depth%uFF09%u3001%u540D%u79F0%uFF08name%uFF09%u3001%u4F4D%u7F6E%uFF08x%uFF0Cy%uFF09%u4FE1%u606F%u3002%0A%21%5BAlt%20text%5D%28./1531465804338.png%29%0A%u8F93%u51FA%u8FDE%u7EBF%u7684%u7ED3%u679C%uFF1A%0Alinks%20%u4E2D%u6709%u8FDE%u7EBF%u4E24%u7AEF%uFF08%20source%20%2C%20target%20%uFF09%u7684%u8282%u70B9%u4FE1%u606F%u3002%0A%21%5BAlt%20text%5D%28./1531465817857.png%29%0A%0A%0A%60%u7ED8%u5236%60%0Ad3.svg.diagonal%28%29%20%60%u5BF9%u89D2%u7EBF%u751F%u6210%u5668%60%uFF0C%u53EA%u9700%u8981%u8F93%u5165%u4E24%u4E2A%u9876%u70B9%u5750%u6807%uFF0C%u5373%u53EF%u751F%u6210%u4E00%u6761%60%u8D1D%u585E%u5C14%u66F2%u7EBF%60%u3002%0A%u521B%u5EFA%u4E00%u4E2A%u5BF9%u89D2%u7EBF%u751F%u6210%u5668%uFF1A%0Aprojection%28%29%20%u662F%u4E00%u4E2A%60%u70B9%u53D8%u6362%u5668%60%uFF0C%u9ED8%u8BA4%u662F%20%5B%20d.x%20%2C%20d.y%20%5D%uFF0C%u5373%u4FDD%u6301%u539F%u5750%u6807%u4E0D%u53D8%uFF0C%u5982%u679C%u5199%u6210%20%5B%20d.y%20%2C%20d.x%20%5D%20%uFF0C%u5373%u662F%u8BF4%u5BF9%u4EFB%u610F%u8F93%u5165%u7684%u9876%u70B9%uFF0C%u90FD%u4EA4%u6362%20x%20%u548C%20y%20%u5750%u6807%u3002%u8FD9%u91CC%u662F%u628A%60%u7531%u4E0A%u5230%u4E0B%u7684%u6811%60%u6539%u53D8%u4E3A%60%u6A2A%u5411%u7684%u6811%60%u3002%0A%60%60%60javascript%0Avar%20diagonal%20%3D%20d3.svg.diagonal%28%29%0A%20%20%20%20.projection%28function%28d%29%20%7B%20return%20%5Bd.y%2C%20d.x%5D%3B%20%7D%29%3B%0A%60%60%60%0A%0A%u5206%u522B%u7ED8%u5236%u4E09%u79CD%u56FE%u5F62%u5143%u7D20%uFF1A%0A-%09line%uFF0C%u7EBF%u6BB5%uFF0C%u8868%u793A%u8FDE%u7EBF%u3002%0A-%09circle%uFF0C%u5706%uFF0C%u8868%u793A%u8282%u70B9%u3002%0A-%09text%uFF0C%u6587%u5B57%uFF0C%u63CF%u8FF0%u8282%u70B9%u3002%0A%0A%60%60%60javascript%0A%09%09//%20line%0A%09%09var%20link%20%3D%20svg.selectAll%28%22.link%22%29%0A%09%09%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.data%28links%29%0A%09%09%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.enter%28%29%0A%09%09%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.append%28%22path%22%29%0A%09%09%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22class%22%2C%20%22link%22%29%0A%09%09%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22d%22%2C%20diagonal%29%3B%20%20//%u4F7F%u7528%u5BF9%u89D2%u7EBF%u751F%u6210%u5668%0A%0A%09%09%09//%20node%u5305%u542Bcircel%u548Ctext%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20node%20%3D%20svg.selectAll%28%22.node%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.data%28nodes%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.enter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.append%28%22g%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22class%22%2C%20%22node%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22transform%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%22translate%28%22%20+%20d.y%20+%20%22%2C%22%20+%20d.x%20+%20%22%29%22%3B%20//%20%u5E73%u79FB%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20node.append%28%22circle%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22r%22%2C%204.5%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20node.append%28%22text%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22dx%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20d.children%20%3F%20-8%20%3A%208%3B%20//%20%u5982%u679C%u67D0%u8282%u70B9%u662F%u53F6%u5B50%u8282%u70B9%uFF0C%u5219%u8282%u70B9%u6587%u5B57%u5728%u5706%u5708%u7684%u53F3%u8FB9%uFF0C%u5426%u5219%u5728%u5DE6%u8FB9%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22dy%22%2C%203%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.style%28%22text-anchor%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20d.children%20%3F%20%22end%22%20%3A%20%22start%22%3B%20//%20%u5982%u679C%u67D0%u8282%u70B9%u662F%u53F6%u5B50%u8282%u70B9%uFF0C%u5219%u8282%u70B9%u6587%u5B57%u5728%u5706%u5708%u7684%u53F3%u8FB9%uFF0C%u5426%u5219%u5728%u5DE6%u8FB9%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.text%28function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20d.name%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%60%60%60%0A%0A%0A%0A%23%23%23%23%u7B2C%u5341%u4E94%u7AE0%20%u4E2D%u56FD%u5730%u56FE%0A%60GeoJSON%60%20%u662F%u7528%u4E8E%u63CF%u8FF0%u5730%u7406%u7A7A%u95F4%u4FE1%u606F%u7684%u6570%u636E%u683C%u5F0F%u3002GeoJSON%20%u4E0D%u662F%u4E00%u79CD%u65B0%u7684%u683C%u5F0F%uFF0C%u5176%u8BED%u6CD5%u89C4%u8303%u662F%u7B26%u5408%20JSON%20%u683C%u5F0F%u7684%uFF0C%u53EA%u4E0D%u8FC7%u5BF9%u5176%u540D%u79F0%u8FDB%u884C%u4E86%u89C4%u8303%uFF0C%u4E13%u95E8%u7528%u4E8E%u8868%u793A%u5730%u7406%u4FE1%u606F%u3002%0A%21%5BAlt%20text%5D%28./1531485638681.png%29%0A%60%u6570%u636E%60%0A%5Bchina.geojson%5D%28http%3A//www.ourd3js.com/demo/rm/R-10.0/china.geojson%29%0A%60%u6295%u5F71%u51FD%u6570%60%0A%u7531%u4E8E%20GeoJSON%20%u6587%u4EF6%u4E2D%u7684%u5730%u56FE%u6570%u636E%uFF0C%u90FD%u662F%u7ECF%u5EA6%u548C%u7EAC%u5EA6%u7684%u4FE1%u606F%u3002%u5B83%u4EEC%u90FD%u662F%u4E09%u7EF4%u7684%uFF0C%u800C%u8981%u5728%u7F51%u9875%u4E0A%u663E%u793A%u7684%u662F%u4E8C%u7EF4%u7684%uFF0C%u6240%u4EE5%u8981%u8BBE%u5B9A%u4E00%u4E2A%u6295%u5F71%u51FD%u6570%u6765%u8F6C%u6362%u7ECF%u5EA6%u7EAC%u5EA6%u3002%0A%60%60%60javascript%0A%20//%20%u6295%u5F71%u51FD%u6570%0A%20var%20projection%20%3D%20d3.geo.mercator%28%29%0A%20%20%20%20%20%20%20%20%20%20.center%28%5B107%2C%2031%5D%29%20//%20%u5B9A%u5730%u56FE%u7684%u4E2D%u5FC3%u4F4D%u7F6E%uFF0C%5B107%2C31%5D%20%u6307%u7684%u662F%u7ECF%u5EA6%u548C%u7EAC%u5EA6%u3002%0A%20%20%20%20%20%20%20%20%20%20.scale%28850%29%20//%20%u5B9A%u653E%u5927%u7684%u6BD4%u4F8B%0A%20%20%20%20%20%20%20%20%20%20.translate%28%5Bwidth%20/%202%2C%20height%20/%202%5D%29%3B%20//%20%u8BBE%u5B9A%u5E73%u79FB%0A%60%60%60%0A%0A%60%u5730%u7406%u8DEF%u5F84%u751F%u6210%u5668%60%0A%u751F%u6210path%20%u5143%u7D20%u7684%u8DEF%u5F84%u503C%0A%60%60%60javascript%0A%20%20//%20%u5730%u7406%u8DEF%u5F84%u751F%u6210%u5668%0A%20%20var%20path%20%3D%20d3.geo.path%28%29%0A%20%20%20%20%20%20%20.projection%28projection%29%3B%20//%20%u8BBE%u5B9A%u8DEF%u5F84%u751F%u6210%u5668%u7684%u6295%u5F71%u51FD%u6570%0A%60%60%60%0A%u5411%u670D%u52A1%u5668%u8BF7%u6C42%u6587%u4EF6%u5E76%u7ED8%u5236%u5730%u56FE%0A%60%60%60javascript%0A%20%20//%20%20%u5411%u670D%u52A1%u5668%u8BF7%u6C42%u6587%u4EF6%u5E76%u7ED8%u5236%u5730%u56FE%0A%20%20%20//%20%u6240%u6709%u8BFB%u53D6%u5230%u7684%u4FE1%u606F%u4F1A%u88AB%u653E%u5230root%u4E2D%0A%20%20%20%20%20%20%20%20d3.json%28%22china.geojson%22%2C%20function%20%28error%2C%20root%29%20%7B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28error%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20console.error%28error%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log%28root.features%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20svg.selectAll%28%22path%22%29%20//%20%u6BCF%u4E00%u4E2A%3Cpath%3E%u4EE3%u8868%u4E00%u4E2A%u7701%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.data%28root.features%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.enter%28%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.append%28%22path%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22stroke%22%2C%20%22%23000%22%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22stroke-width%22%2C%201%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22fill%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20color%28i%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22d%22%2C%20function%20%28d%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20path%28d%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20.attr%28%22d%22%2C%20path%29%20//%20%u4F7F%u7528%u5730%u7406%u8DEF%u5F84%u751F%u6210%u5668%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.on%28%22mouseover%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20d3.select%28this%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22fill%22%2C%20%22yellow%22%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.on%28%22mouseout%22%2C%20function%20%28d%2C%20i%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20d3.select%28this%29%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20.attr%28%22fill%22%2C%20color%28i%29%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%29%3B%0A%20%20%20%20%20%20%20%20%7D%29%3B%0A%60%60%60%0A%0A%0A%u9644%u4EF6%uFF1A%0A%0A</center><br/></span>
</div></body></html> 